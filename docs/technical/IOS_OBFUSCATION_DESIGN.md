# iOSä»£ç æ··æ·†åŠŸèƒ½è®¾è®¡æ–‡æ¡£

## æ–‡æ¡£ä¿¡æ¯
- **åˆ›å»ºæ—¥æœŸ**: 2025-10-13
- **ç‰ˆæœ¬**: v1.0.0
- **å‚è€ƒé¡¹ç›®**: WHC_ConfuseSoftware
- **ç›®æ ‡**: ä¸ºMarsæ—¥å¿—åˆ†æå·¥å…·æ·»åŠ iOSåŸç”Ÿé¡¹ç›®æ··æ·†åŠŸèƒ½

---

## ä¸€ã€é¡¹ç›®èƒŒæ™¯

### 1.1 WHC_ConfuseSoftware æ ¸å¿ƒåŠŸèƒ½åˆ†æ

æ ¹æ®å¯¹WHC_ConfuseSoftwareé¡¹ç›®çš„åˆ†æï¼Œè¯¥å•†ä¸šæ··æ·†è½¯ä»¶æä¾›ä»¥ä¸‹æ ¸å¿ƒåŠŸèƒ½ï¼š

#### iOSåŸç”Ÿæ··æ·†èƒ½åŠ›
1. **æ–‡ä»¶åæ··æ·†** - ä¿®æ”¹.h/.m/.swiftæ–‡ä»¶å
2. **ç±»åæ··æ·†** - ä¿®æ”¹Objective-Cå’ŒSwiftç±»å
3. **å‡½æ•°åæ··æ·†** - ä¿®æ”¹æ–¹æ³•ç­¾å
4. **å±æ€§åæ··æ·†** - ä¿®æ”¹å±æ€§å’Œå˜é‡å
5. **èµ„æºæ–‡ä»¶æ··æ·†** - ä¿®æ”¹å›¾ç‰‡ã€éŸ³é¢‘ç­‰èµ„æºæ–‡ä»¶å
6. **åƒåœ¾ä»£ç æ’å…¥** - ç”Ÿæˆå¹¶æ’å…¥æ— ç”¨ä»£ç 
7. **å­—ç¬¦ä¸²åŠ å¯†** - åŠ å¯†ç¡¬ç¼–ç å­—ç¬¦ä¸²
8. **UIColorå€¼æ··æ·†** - ä¿®æ”¹é¢œè‰²å€¼
9. **Xib/Storyboardæ··æ·†** - ä¿®æ”¹æ§ä»¶ID
10. **å‡½æ•°é¡ºåºæ‰“ä¹±** - æ”¹å˜å‡½æ•°å®šä¹‰é¡ºåº
11. **åè®®åç§°æ··æ·†** - ä¿®æ”¹Protocolåç§°
12. **å®å®šä¹‰æ··æ·†** - ä¿®æ”¹å®åç§°
13. **æšä¸¾æ··æ·†** - ä¿®æ”¹æšä¸¾ç±»å‹å’Œå€¼
14. **å±€éƒ¨å˜é‡æ··æ·†** - ä¿®æ”¹å‡½æ•°å†…å±€éƒ¨å˜é‡å

#### é«˜çº§åŠŸèƒ½
- **å‡½æ•°æ‹†åˆ†** - å°†å‡½æ•°æ‹†åˆ†æˆå¤šä¸ªå­å‡½æ•°
- **ä»£ç æ ¼å¼åŒ–** - é‡æ–°æ ¼å¼åŒ–ä»£ç ç»“æ„
- **é¡¹ç›®å…‹éš†** - åˆ›å»ºé¡¹ç›®å‰¯æœ¬å¹¶ä¿®æ”¹æ ‡è¯†
- **å›ºå®šæ··æ·†** - ä¿æŒæ··æ·†ç»“æœä¸€è‡´æ€§ï¼ˆç”¨äºç‰ˆæœ¬è¿­ä»£ï¼‰
- **æ³¨é‡Šæ¸…ç†** - ç§»é™¤ä»£ç æ³¨é‡Š

### 1.2 é€‚ç”¨åœºæ™¯
- **åº”ç”¨ä¸Šæ¶å®¡æ ¸** - è§£å†³ä»£ç é‡å¤é—®é¢˜ï¼ˆ4.3ã€2.1ç­‰å®¡æ ¸é—®é¢˜ï¼‰
- **ä»£ç ä¿æŠ¤** - é˜²æ­¢é€†å‘å·¥ç¨‹
- **ç‰ˆæœ¬è¿­ä»£** - æŒç»­æ··æ·†è€Œä¸å½±å“åŠŸèƒ½

---

## äºŒã€åŠŸèƒ½è®¾è®¡

### 2.1 ç›®æ ‡å®šä½

**é˜¶æ®µä¸€ç›®æ ‡ï¼ˆå½“å‰ï¼‰**ï¼š
- ä¸“æ³¨äºiOSåŸç”Ÿé¡¹ç›®ï¼ˆObjective-C/Swiftï¼‰
- å®ç°åŸºç¡€ä½†å®ç”¨çš„æ··æ·†åŠŸèƒ½
- æ¨¡å—åŒ–æ¶æ„ï¼Œä¾¿äºåç»­æ‰©å±•
- æš‚ä¸æ¶‰åŠFlutterã€Unity3Dç­‰è·¨å¹³å°æ¡†æ¶

**åŠŸèƒ½ä¼˜å…ˆçº§**ï¼š
```
P0 (å¿…é¡»å®ç°):
  - æ–‡ä»¶åæ··æ·†
  - ç±»åæ··æ·†
  - å‡½æ•°åæ··æ·†
  - å±æ€§åæ··æ·†
  - èµ„æºæ–‡ä»¶æ··æ·†ï¼ˆå›¾ç‰‡ï¼‰

P1 (é‡è¦):
  - åƒåœ¾ä»£ç æ’å…¥
  - å­—ç¬¦ä¸²åŠ å¯†
  - æ³¨é‡Šæ¸…ç†

P2 (å¯é€‰):
  - å‡½æ•°é¡ºåºæ‰“ä¹±
  - åè®®åæ··æ·†
  - æšä¸¾æ··æ·†
  - UIColoræ··æ·†
```

### 2.2 æ ¸å¿ƒæ¨¡å—è®¾è®¡

#### æ¨¡å—ç»“æ„
```
gui/modules/obfuscation/
â”œâ”€â”€ __init__.py                   # æ¨¡å—åˆå§‹åŒ–
â”œâ”€â”€ obfuscation_tab.py           # GUIæ ‡ç­¾é¡µï¼ˆä¸»å…¥å£ï¼‰
â”œâ”€â”€ obfuscation_cli.py           # å‘½ä»¤è¡Œå·¥å…·ï¼ˆæ–°å¢ï¼‰
â”œâ”€â”€ project_analyzer.py          # é¡¹ç›®åˆ†æå™¨
â”œâ”€â”€ name_generator.py            # åç§°ç”Ÿæˆå™¨
â”œâ”€â”€ code_parser.py               # ä»£ç è§£æå™¨
â”œâ”€â”€ code_transformer.py          # ä»£ç è½¬æ¢å™¨
â”œâ”€â”€ resource_handler.py          # èµ„æºæ–‡ä»¶å¤„ç†å™¨
â”œâ”€â”€ garbage_generator.py         # åƒåœ¾ä»£ç ç”Ÿæˆå™¨
â”œâ”€â”€ string_encryptor.py          # å­—ç¬¦ä¸²åŠ å¯†å™¨
â”œâ”€â”€ config_manager.py            # é…ç½®ç®¡ç†å™¨
â”œâ”€â”€ whitelist_manager.py         # ç™½åå•ç®¡ç†å™¨
â”œâ”€â”€ obfuscation_engine.py        # æ··æ·†å¼•æ“ï¼ˆæ ¸å¿ƒè°ƒåº¦ï¼‰
â””â”€â”€ CLAUDE.md                    # æ¨¡å—æŠ€æœ¯æ–‡æ¡£

scripts/
â”œâ”€â”€ obfuscate.sh                 # Shellè„šæœ¬å°è£…ï¼ˆæ–°å¢ï¼‰
â””â”€â”€ obfuscate.py                 # Python CLIå…¥å£ï¼ˆæ–°å¢ï¼‰
```

### 2.3 æ•°æ®æµè®¾è®¡

```
ç”¨æˆ·æ“ä½œ â†’ GUIç•Œé¢(obfuscation_tab.py)
    â†“
é…ç½®åŠ è½½(config_manager.py) + ç™½åå•åŠ è½½(whitelist_manager.py)
    â†“
é¡¹ç›®åˆ†æ(project_analyzer.py)
    â”œâ†’ æ‰«æé¡¹ç›®ç»“æ„
    â”œâ†’ è¯†åˆ«ä»£ç æ–‡ä»¶
    â”œâ†’ è¯†åˆ«èµ„æºæ–‡ä»¶
    â””â†’ è¯†åˆ«é…ç½®æ–‡ä»¶
    â†“
ä»£ç è§£æ(code_parser.py)
    â”œâ†’ è§£æObjective-Cä»£ç 
    â”œâ†’ è§£æSwiftä»£ç 
    â”œâ†’ æå–ç±»ã€å‡½æ•°ã€å±æ€§
    â””â†’ æ„å»ºä¾èµ–å…³ç³»å›¾
    â†“
åç§°ç”Ÿæˆ(name_generator.py)
    â”œâ†’ ç”Ÿæˆæ··æ·†åçš„ç±»å
    â”œâ†’ ç”Ÿæˆæ··æ·†åçš„å‡½æ•°å
    â”œâ†’ ç”Ÿæˆæ··æ·†åçš„å±æ€§å
    â””â†’ ç”Ÿæˆæ··æ·†åçš„æ–‡ä»¶å
    â†“
ä»£ç è½¬æ¢(code_transformer.py)
    â”œâ†’ æ›¿æ¢ç±»å
    â”œâ†’ æ›¿æ¢å‡½æ•°å
    â”œâ†’ æ›¿æ¢å±æ€§å
    â”œâ†’ æ’å…¥åƒåœ¾ä»£ç 
    â”œâ†’ åŠ å¯†å­—ç¬¦ä¸²
    â””â†’ æ¸…ç†æ³¨é‡Š
    â†“
èµ„æºå¤„ç†(resource_handler.py)
    â”œâ†’ ä¿®æ”¹å›¾ç‰‡æ–‡ä»¶å
    â”œâ†’ åŒæ­¥ä»£ç ä¸­çš„å¼•ç”¨
    â””â†’ ä¿®æ”¹èµ„æºé…ç½®æ–‡ä»¶
    â†“
æ··æ·†å¼•æ“è°ƒåº¦(obfuscation_engine.py)
    â”œâ†’ åè°ƒå„æ¨¡å—æ‰§è¡Œ
    â”œâ†’ è¿›åº¦ç›‘æ§
    â”œâ†’ é”™è¯¯å¤„ç†
    â””â†’ æ—¥å¿—è®°å½•
    â†“
è¾“å‡ºç»“æœ
    â”œâ†’ æ··æ·†åçš„ä»£ç 
    â”œâ†’ æ··æ·†æ˜ å°„è¡¨
    â””â†’ æ··æ·†æŠ¥å‘Š
```

---

## ä¸‰ã€è¯¦ç»†åŠŸèƒ½è®¾è®¡

### 3.1 é¡¹ç›®åˆ†æå™¨ (project_analyzer.py)

**åŠŸèƒ½**ï¼š
- æ‰«æé¡¹ç›®ç›®å½•ç»“æ„
- è¯†åˆ«.xcodeproj/.xcworkspaceæ–‡ä»¶
- æå–æºä»£ç æ–‡ä»¶(.h/.m/.swift)
- æå–èµ„æºæ–‡ä»¶(.png/.jpg/.xcassetsç­‰)
- æå–é…ç½®æ–‡ä»¶(.plist/.stringsç­‰)
- åˆ†æé¡¹ç›®ä¾èµ–ï¼ˆCocoaPodsã€Swift Package Managerï¼‰

**æ¥å£è®¾è®¡**ï¼š
```python
class ProjectAnalyzer:
    def __init__(self, project_path: str):
        """åˆå§‹åŒ–é¡¹ç›®åˆ†æå™¨"""

    def scan_project(self) -> ProjectStructure:
        """æ‰«æé¡¹ç›®ç»“æ„"""

    def get_source_files(self, language: str = 'all') -> List[str]:
        """è·å–æºä»£ç æ–‡ä»¶åˆ—è¡¨"""

    def get_resource_files(self) -> List[str]:
        """è·å–èµ„æºæ–‡ä»¶åˆ—è¡¨"""

    def get_dependencies(self) -> Dict[str, List[str]]:
        """è·å–é¡¹ç›®ä¾èµ–å…³ç³»"""

    def validate_project(self) -> Tuple[bool, str]:
        """éªŒè¯é¡¹ç›®æ˜¯å¦å¯æ··æ·†"""
```

**æ•°æ®æ¨¡å‹**ï¼š
```python
@dataclass
class ProjectStructure:
    project_path: str
    project_name: str
    source_files: List[SourceFile]
    resource_files: List[ResourceFile]
    config_files: List[ConfigFile]
    dependencies: Dict[str, List[str]]

@dataclass
class SourceFile:
    path: str
    name: str
    language: str  # 'objc', 'swift'
    type: str      # 'header', 'implementation'
```

### 3.2 ä»£ç è§£æå™¨ (code_parser.py)

**åŠŸèƒ½**ï¼š
- è§£æObjective-Cä»£ç ï¼ˆä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æˆ–ASTï¼‰
- è§£æSwiftä»£ç ï¼ˆä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æˆ–SwiftSyntaxï¼‰
- æå–ç±»å®šä¹‰ã€å‡½æ•°å®šä¹‰ã€å±æ€§å®šä¹‰
- æ„å»ºç¬¦å·è¡¨å’Œä¾èµ–å›¾

**æ¥å£è®¾è®¡**ï¼š
```python
class CodeParser:
    def __init__(self):
        """åˆå§‹åŒ–ä»£ç è§£æå™¨"""

    def parse_objc_file(self, file_path: str) -> ParsedFile:
        """è§£æObjective-Cæ–‡ä»¶"""

    def parse_swift_file(self, file_path: str) -> ParsedFile:
        """è§£æSwiftæ–‡ä»¶"""

    def extract_classes(self, parsed_file: ParsedFile) -> List[ClassInfo]:
        """æå–ç±»ä¿¡æ¯"""

    def extract_methods(self, parsed_file: ParsedFile) -> List[MethodInfo]:
        """æå–æ–¹æ³•ä¿¡æ¯"""

    def extract_properties(self, parsed_file: ParsedFile) -> List[PropertyInfo]:
        """æå–å±æ€§ä¿¡æ¯"""
```

**æ•°æ®æ¨¡å‹**ï¼š
```python
@dataclass
class ParsedFile:
    file_path: str
    language: str
    imports: List[str]
    classes: List[ClassInfo]
    protocols: List[ProtocolInfo]
    enums: List[EnumInfo]

@dataclass
class ClassInfo:
    name: str
    super_class: str
    protocols: List[str]
    methods: List[MethodInfo]
    properties: List[PropertyInfo]
    line_start: int
    line_end: int

@dataclass
class MethodInfo:
    name: str
    return_type: str
    parameters: List[Parameter]
    is_class_method: bool
    line_start: int
    line_end: int
```

### 3.3 åç§°ç”Ÿæˆå™¨ (name_generator.py)

**åŠŸèƒ½**ï¼š
- ç”Ÿæˆæ··æ·†åçš„åç§°ï¼ˆç±»åã€å‡½æ•°åã€å±æ€§åï¼‰
- æ”¯æŒå¤šç§å‘½åç­–ç•¥ï¼ˆéšæœºã€å‰ç¼€ã€æ¨¡å¼ï¼‰
- é¿å…ä¸ç³»ç»ŸAPIå†²çª
- ä¿è¯åç§°å”¯ä¸€æ€§

**å‘½åç­–ç•¥**ï¼š
```python
class NamingStrategy:
    RANDOM = 'random'          # å®Œå…¨éšæœº: Abc123Def
    PREFIX = 'prefix'          # å‰ç¼€æ¨¡å¼: XY_OriginalName
    PATTERN = 'pattern'        # æ¨¡å¼åŒ¹é…: CapitalWord
    DICTIONARY = 'dictionary'  # è¯å…¸æ¨¡å¼: ä½¿ç”¨çœŸå®å•è¯
```

**æ¥å£è®¾è®¡**ï¼š
```python
class NameGenerator:
    def __init__(self, strategy: str = NamingStrategy.RANDOM):
        """åˆå§‹åŒ–åç§°ç”Ÿæˆå™¨"""

    def generate_class_name(self, original_name: str = None) -> str:
        """ç”Ÿæˆç±»å"""

    def generate_method_name(self, original_name: str = None) -> str:
        """ç”Ÿæˆæ–¹æ³•å"""

    def generate_property_name(self, original_name: str = None) -> str:
        """ç”Ÿæˆå±æ€§å"""

    def generate_file_name(self, original_name: str = None) -> str:
        """ç”Ÿæˆæ–‡ä»¶å"""

    def is_name_available(self, name: str) -> bool:
        """æ£€æŸ¥åç§°æ˜¯å¦å¯ç”¨"""

    def add_to_blacklist(self, names: List[str]):
        """æ·»åŠ åˆ°é»‘åå•"""
```

### 3.4 ä»£ç è½¬æ¢å™¨ (code_transformer.py)

**åŠŸèƒ½**ï¼š
- æ‰§è¡Œä»£ç æ›¿æ¢ï¼ˆç±»åã€å‡½æ•°åã€å±æ€§åï¼‰
- åŒæ­¥ä¿®æ”¹å¤´æ–‡ä»¶å’Œå®ç°æ–‡ä»¶
- åŒæ­¥ä¿®æ”¹Xib/Storyboardå¼•ç”¨
- ä¿æŒä»£ç å¯ç¼–è¯‘æ€§

**æ¥å£è®¾è®¡**ï¼š
```python
class CodeTransformer:
    def __init__(self, mapping: NameMapping):
        """åˆå§‹åŒ–ä»£ç è½¬æ¢å™¨"""

    def transform_file(self, file_path: str) -> bool:
        """è½¬æ¢å•ä¸ªæ–‡ä»¶"""

    def transform_class_names(self, file_path: str) -> bool:
        """è½¬æ¢ç±»å"""

    def transform_method_names(self, file_path: str) -> bool:
        """è½¬æ¢æ–¹æ³•å"""

    def transform_property_names(self, file_path: str) -> bool:
        """è½¬æ¢å±æ€§å"""

    def remove_comments(self, file_path: str) -> bool:
        """ç§»é™¤æ³¨é‡Š"""

    def backup_file(self, file_path: str) -> str:
        """å¤‡ä»½æ–‡ä»¶"""
```

**æ•°æ®æ¨¡å‹**ï¼š
```python
@dataclass
class NameMapping:
    """åç§°æ˜ å°„è¡¨"""
    class_mappings: Dict[str, str]      # åŸç±»å -> æ–°ç±»å
    method_mappings: Dict[str, str]     # åŸæ–¹æ³•å -> æ–°æ–¹æ³•å
    property_mappings: Dict[str, str]   # åŸå±æ€§å -> æ–°å±æ€§å
    file_mappings: Dict[str, str]       # åŸæ–‡ä»¶å -> æ–°æ–‡ä»¶å
```

### 3.5 åƒåœ¾ä»£ç ç”Ÿæˆå™¨ (garbage_generator.py)

**åŠŸèƒ½**ï¼š
- ç”Ÿæˆæ— ç”¨ä½†åˆæ³•çš„ä»£ç 
- ç”Ÿæˆåƒåœ¾æ–¹æ³•
- ç”Ÿæˆåƒåœ¾å±æ€§
- è‡ªåŠ¨è°ƒç”¨åƒåœ¾ä»£ç 

**æ¥å£è®¾è®¡**ï¼š
```python
class GarbageGenerator:
    def __init__(self, language: str = 'objc'):
        """åˆå§‹åŒ–åƒåœ¾ä»£ç ç”Ÿæˆå™¨"""

    def generate_garbage_method(self) -> str:
        """ç”Ÿæˆåƒåœ¾æ–¹æ³•"""

    def generate_garbage_property(self) -> str:
        """ç”Ÿæˆåƒåœ¾å±æ€§"""

    def generate_garbage_class(self, class_name: str) -> str:
        """ç”Ÿæˆåƒåœ¾ç±»"""

    def insert_garbage_code(self, file_path: str, count: int = 5) -> bool:
        """æ’å…¥åƒåœ¾ä»£ç åˆ°æ–‡ä»¶"""
```

### 3.6 å­—ç¬¦ä¸²åŠ å¯†å™¨ (string_encryptor.py)

**åŠŸèƒ½**ï¼š
- åŠ å¯†ç¡¬ç¼–ç å­—ç¬¦ä¸²
- ç”Ÿæˆè§£å¯†å‡½æ•°
- æ›¿æ¢åŸå­—ç¬¦ä¸²ä¸ºè§£å¯†è°ƒç”¨

**æ¥å£è®¾è®¡**ï¼š
```python
class StringEncryptor:
    def __init__(self, algorithm: str = 'base64'):
        """åˆå§‹åŒ–å­—ç¬¦ä¸²åŠ å¯†å™¨"""

    def encrypt_string(self, text: str) -> str:
        """åŠ å¯†å­—ç¬¦ä¸²"""

    def generate_decrypt_function(self, language: str) -> str:
        """ç”Ÿæˆè§£å¯†å‡½æ•°"""

    def replace_strings_in_file(self, file_path: str) -> int:
        """æ›¿æ¢æ–‡ä»¶ä¸­çš„å­—ç¬¦ä¸²"""
```

### 3.7 èµ„æºæ–‡ä»¶å¤„ç†å™¨ (resource_handler.py)

**åŠŸèƒ½**ï¼š
- ä¿®æ”¹å›¾ç‰‡æ–‡ä»¶å
- ä¿®æ”¹Assets.xcassetsä¸­çš„èµ„æºåç§°
- åŒæ­¥ä»£ç ä¸­çš„èµ„æºå¼•ç”¨
- ä¿®æ”¹Info.plistç­‰é…ç½®æ–‡ä»¶

**æ¥å£è®¾è®¡**ï¼š
```python
class ResourceHandler:
    def __init__(self, project_path: str):
        """åˆå§‹åŒ–èµ„æºå¤„ç†å™¨"""

    def rename_image_files(self, mapping: Dict[str, str]) -> bool:
        """é‡å‘½åå›¾ç‰‡æ–‡ä»¶"""

    def update_assets_catalog(self, mapping: Dict[str, str]) -> bool:
        """æ›´æ–°Assetsç›®å½•"""

    def sync_code_references(self, mapping: Dict[str, str]) -> bool:
        """åŒæ­¥ä»£ç ä¸­çš„å¼•ç”¨"""

    def update_plist_files(self, mapping: Dict[str, str]) -> bool:
        """æ›´æ–°plistæ–‡ä»¶"""
```

### 3.8 ç™½åå•ç®¡ç†å™¨ (whitelist_manager.py)

**åŠŸèƒ½**ï¼š
- ç®¡ç†ä¸å¯æ··æ·†çš„åç§°
- åŠ è½½å’Œä¿å­˜ç™½åå•é…ç½®
- ç³»ç»ŸAPIè‡ªåŠ¨è¿‡æ»¤

**æ¥å£è®¾è®¡**ï¼š
```python
class WhitelistManager:
    def __init__(self, config_path: str = None):
        """åˆå§‹åŒ–ç™½åå•ç®¡ç†å™¨"""

    def load_whitelist(self, file_path: str) -> bool:
        """åŠ è½½ç™½åå•"""

    def save_whitelist(self, file_path: str) -> bool:
        """ä¿å­˜ç™½åå•"""

    def add_class(self, class_name: str):
        """æ·»åŠ ç±»åˆ°ç™½åå•"""

    def add_method(self, method_name: str):
        """æ·»åŠ æ–¹æ³•åˆ°ç™½åå•"""

    def is_whitelisted(self, name: str, type: str) -> bool:
        """æ£€æŸ¥æ˜¯å¦åœ¨ç™½åå•ä¸­"""

    def get_system_apis(self) -> Set[str]:
        """è·å–ç³»ç»ŸAPIåˆ—è¡¨"""
```

**ç™½åå•é…ç½®æ ¼å¼**ï¼š
```json
{
    "classes": [
        "UIViewController",
        "NSObject",
        "AppDelegate"
    ],
    "methods": [
        "viewDidLoad",
        "viewWillAppear:",
        "applicationDidFinishLaunching:"
    ],
    "properties": [
        "delegate",
        "dataSource"
    ],
    "files": [
        "AppDelegate",
        "SceneDelegate"
    ],
    "directories": [
        "Pods/",
        "Carthage/"
    ]
}
```

### 3.9 é…ç½®ç®¡ç†å™¨ (config_manager.py)

**åŠŸèƒ½**ï¼š
- åŠ è½½å’Œä¿å­˜æ··æ·†é…ç½®
- ç®¡ç†æ··æ·†å‚æ•°
- é…ç½®éªŒè¯

**é…ç½®é¡¹**ï¼š
```json
{
    "project_path": "/path/to/project",
    "output_path": "/path/to/output",
    "language": "objc",  // "objc", "swift", "both"

    "obfuscation": {
        "class_names": true,
        "method_names": true,
        "property_names": true,
        "file_names": true,
        "resource_names": true
    },

    "naming": {
        "strategy": "random",  // "random", "prefix", "pattern"
        "prefix": "XY_",
        "min_length": 8,
        "max_length": 16
    },

    "garbage_code": {
        "enabled": true,
        "methods_per_class": 5,
        "properties_per_class": 3
    },

    "string_encryption": {
        "enabled": true,
        "algorithm": "base64",
        "exclude_short": true,
        "min_length": 3
    },

    "cleanup": {
        "remove_comments": true,
        "remove_whitespace": false
    },

    "whitelist_file": "./whitelist.json",
    "backup": true
}
```

### 3.10 æ··æ·†å¼•æ“ (obfuscation_engine.py)

**åŠŸèƒ½**ï¼š
- åè°ƒæ‰€æœ‰æ¨¡å—çš„æ‰§è¡Œ
- ç®¡ç†æ··æ·†æµç¨‹
- è¿›åº¦ç›‘æ§å’ŒæŠ¥å‘Š
- é”™è¯¯å¤„ç†å’Œå›æ»š

**æ¥å£è®¾è®¡**ï¼š
```python
class ObfuscationEngine:
    def __init__(self, config: ObfuscationConfig):
        """åˆå§‹åŒ–æ··æ·†å¼•æ“"""

    def start_obfuscation(self, callback: Callable = None) -> ObfuscationResult:
        """å¼€å§‹æ··æ·†"""

    def get_progress(self) -> float:
        """è·å–æ··æ·†è¿›åº¦"""

    def pause(self):
        """æš‚åœæ··æ·†"""

    def resume(self):
        """æ¢å¤æ··æ·†"""

    def cancel(self):
        """å–æ¶ˆæ··æ·†"""

    def rollback(self):
        """å›æ»šæ··æ·†"""
```

**æ•°æ®æ¨¡å‹**ï¼š
```python
@dataclass
class ObfuscationResult:
    success: bool
    message: str
    stats: ObfuscationStats
    mapping_file: str
    log_file: str

@dataclass
class ObfuscationStats:
    files_processed: int
    classes_obfuscated: int
    methods_obfuscated: int
    properties_obfuscated: int
    resources_obfuscated: int
    garbage_code_inserted: int
    strings_encrypted: int
    duration: float  # ç§’
```

### 3.11 GUIæ ‡ç­¾é¡µ (obfuscation_tab.py)

**åŠŸèƒ½**ï¼š
- æä¾›ç”¨æˆ·ç•Œé¢
- é¡¹ç›®é€‰æ‹©å’ŒåŠ è½½
- é…ç½®å‚æ•°è®¾ç½®
- å¯åŠ¨æ··æ·†
- æ˜¾ç¤ºè¿›åº¦å’Œç»“æœ

**ç•Œé¢å¸ƒå±€**ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ iOSä»£ç æ··æ·†                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ é¡¹ç›®è·¯å¾„: [___________________________] [é€‰æ‹©é¡¹ç›®]      â”‚
â”‚ è¾“å‡ºè·¯å¾„: [___________________________] [é€‰æ‹©è¾“å‡º]      â”‚
â”‚                                                          â”‚
â”‚ â”Œâ”€ æ··æ·†é€‰é¡¹ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚ â”‚ â˜‘ ç±»åæ··æ·†     â˜‘ å‡½æ•°åæ··æ·†    â˜‘ å±æ€§åæ··æ·†    â”‚    â”‚
â”‚ â”‚ â˜‘ æ–‡ä»¶åæ··æ·†   â˜‘ èµ„æºæ–‡ä»¶æ··æ·†                   â”‚    â”‚
â”‚ â”‚ â˜‘ åƒåœ¾ä»£ç æ’å…¥ â˜‘ å­—ç¬¦ä¸²åŠ å¯†    â˜‘ æ³¨é‡Šæ¸…ç†      â”‚    â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                          â”‚
â”‚ â”Œâ”€ å‘½åç­–ç•¥ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚ â”‚ â¦¿ éšæœºå‘½å  â—‹ å‰ç¼€æ¨¡å¼  â—‹ è¯å…¸æ¨¡å¼             â”‚    â”‚
â”‚ â”‚ å‰ç¼€: [XY_]  é•¿åº¦: [8] - [16]                   â”‚    â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                          â”‚
â”‚ â”Œâ”€ é«˜çº§é€‰é¡¹ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚ â”‚ ç™½åå•é…ç½®: [whitelist.json] [ç¼–è¾‘]             â”‚    â”‚
â”‚ â”‚ â˜‘ åˆ›å»ºå¤‡ä»½  â˜‘ ç”Ÿæˆæ˜ å°„è¡¨  â˜‘ è¯¦ç»†æ—¥å¿—           â”‚    â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                          â”‚
â”‚ [å¼€å§‹æ··æ·†] [åœæ­¢] [æŸ¥çœ‹æ—¥å¿—] [å¯¼å‡ºé…ç½®]                â”‚
â”‚                                                          â”‚
â”‚ â”Œâ”€ æ··æ·†è¿›åº¦ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚ â”‚ [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘] 65%                 â”‚    â”‚
â”‚ â”‚ æ­£åœ¨å¤„ç†: ViewController.m                       â”‚    â”‚
â”‚ â”‚ å·²å¤„ç†æ–‡ä»¶: 130/200                              â”‚    â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                          â”‚
â”‚ â”Œâ”€ æ··æ·†æ—¥å¿— â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚ â”‚ [2025-10-13 10:23:15] å¼€å§‹åˆ†æé¡¹ç›®...           â”‚    â”‚
â”‚ â”‚ [2025-10-13 10:23:16] å‘ç° 200 ä¸ªæºæ–‡ä»¶         â”‚    â”‚
â”‚ â”‚ [2025-10-13 10:23:17] å¼€å§‹è§£æä»£ç ...           â”‚    â”‚
â”‚ â”‚ [2025-10-13 10:23:20] ç”Ÿæˆæ··æ·†æ˜ å°„è¡¨...         â”‚    â”‚
â”‚ â”‚ [2025-10-13 10:23:25] æ­£åœ¨è½¬æ¢ä»£ç ...           â”‚    â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## å››ã€å‘½ä»¤è¡Œå·¥å…·å’ŒCI/CDé›†æˆ ğŸ†•

### 4.1 è®¾è®¡ç›®æ ‡

é™¤äº†GUIç•Œé¢å¤–ï¼Œæä¾›å‘½ä»¤è¡Œå·¥å…·æ”¯æŒä»¥ä¸‹åœºæ™¯ï¼š
1. **æœ¬åœ°è°ƒè¯•** - å¼€å‘è€…åœ¨æœ¬åœ°å¿«é€Ÿæ··æ·†æµ‹è¯•
2. **Jenkinsé›†æˆ** - CI/CDæµæ°´çº¿è‡ªåŠ¨åŒ–æ··æ·†
3. **æ‰¹é‡å¤„ç†** - è„šæœ¬åŒ–æ‰¹é‡æ··æ·†å¤šä¸ªé¡¹ç›®
4. **è¿œç¨‹æ‰§è¡Œ** - SSHè¿œç¨‹è°ƒç”¨æ··æ·†ä»»åŠ¡

### 4.2 å‘½ä»¤è¡Œå·¥å…·è®¾è®¡ (obfuscation_cli.py)

#### 4.2.1 æ¥å£è®¾è®¡

```python
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
iOSä»£ç æ··æ·†å‘½ä»¤è¡Œå·¥å…·
æ”¯æŒæœ¬åœ°è°ƒè¯•å’ŒCI/CDé›†æˆ
"""

import argparse
import sys
import json
from pathlib import Path
from typing import Optional

from .obfuscation_engine import ObfuscationEngine
from .config_manager import ObfuscationConfig


class ObfuscationCLI:
    """å‘½ä»¤è¡Œæ¥å£"""

    def __init__(self):
        self.parser = self._create_parser()

    def _create_parser(self) -> argparse.ArgumentParser:
        """åˆ›å»ºå‘½ä»¤è¡Œå‚æ•°è§£æå™¨"""
        parser = argparse.ArgumentParser(
            prog='ios-obfuscate',
            description='iOSä»£ç æ··æ·†å·¥å…· - æ”¯æŒGUIå’ŒCLIæ¨¡å¼',
            epilog='ç¤ºä¾‹: ios-obfuscate -p /path/to/project -o /path/to/output'
        )

        # å¿…éœ€å‚æ•°
        parser.add_argument(
            '-p', '--project',
            required=True,
            help='iOSé¡¹ç›®è·¯å¾„ (.xcodeproj æˆ– .xcworkspace)'
        )

        parser.add_argument(
            '-o', '--output',
            required=True,
            help='æ··æ·†è¾“å‡ºè·¯å¾„'
        )

        # å¯é€‰å‚æ•°
        parser.add_argument(
            '-c', '--config',
            help='é…ç½®æ–‡ä»¶è·¯å¾„ (JSONæ ¼å¼)'
        )

        parser.add_argument(
            '-w', '--whitelist',
            help='ç™½åå•æ–‡ä»¶è·¯å¾„ (JSONæ ¼å¼)'
        )

        parser.add_argument(
            '-l', '--language',
            choices=['objc', 'swift', 'both'],
            default='both',
            help='ç›®æ ‡è¯­è¨€ (é»˜è®¤: both)'
        )

        # æ··æ·†é€‰é¡¹
        obf_group = parser.add_argument_group('æ··æ·†é€‰é¡¹')
        obf_group.add_argument(
            '--class-names',
            action='store_true',
            help='æ··æ·†ç±»å'
        )
        obf_group.add_argument(
            '--method-names',
            action='store_true',
            help='æ··æ·†æ–¹æ³•å'
        )
        obf_group.add_argument(
            '--property-names',
            action='store_true',
            help='æ··æ·†å±æ€§å'
        )
        obf_group.add_argument(
            '--file-names',
            action='store_true',
            help='æ··æ·†æ–‡ä»¶å'
        )
        obf_group.add_argument(
            '--resource-names',
            action='store_true',
            help='æ··æ·†èµ„æºæ–‡ä»¶å'
        )
        obf_group.add_argument(
            '--all',
            action='store_true',
            help='å¯ç”¨æ‰€æœ‰æ··æ·†é€‰é¡¹'
        )

        # é«˜çº§é€‰é¡¹
        adv_group = parser.add_argument_group('é«˜çº§é€‰é¡¹')
        adv_group.add_argument(
            '--garbage-code',
            action='store_true',
            help='æ’å…¥åƒåœ¾ä»£ç '
        )
        adv_group.add_argument(
            '--string-encrypt',
            action='store_true',
            help='åŠ å¯†å­—ç¬¦ä¸²'
        )
        adv_group.add_argument(
            '--remove-comments',
            action='store_true',
            help='ç§»é™¤æ³¨é‡Š'
        )

        # å‘½åç­–ç•¥
        naming_group = parser.add_argument_group('å‘½åç­–ç•¥')
        naming_group.add_argument(
            '--strategy',
            choices=['random', 'prefix', 'pattern', 'dictionary'],
            default='random',
            help='å‘½åç­–ç•¥ (é»˜è®¤: random)'
        )
        naming_group.add_argument(
            '--prefix',
            default='XY_',
            help='å‰ç¼€æ¨¡å¼çš„å‰ç¼€ (é»˜è®¤: XY_)'
        )
        naming_group.add_argument(
            '--min-length',
            type=int,
            default=8,
            help='åç§°æœ€å°é•¿åº¦ (é»˜è®¤: 8)'
        )
        naming_group.add_argument(
            '--max-length',
            type=int,
            default=16,
            help='åç§°æœ€å¤§é•¿åº¦ (é»˜è®¤: 16)'
        )

        # å…¶ä»–é€‰é¡¹
        parser.add_argument(
            '--no-backup',
            action='store_true',
            help='ä¸åˆ›å»ºå¤‡ä»½'
        )
        parser.add_argument(
            '--verbose',
            action='store_true',
            help='è¯¦ç»†è¾“å‡º'
        )
        parser.add_argument(
            '--quiet',
            action='store_true',
            help='å®‰é™æ¨¡å¼ï¼Œä»…è¾“å‡ºé”™è¯¯'
        )
        parser.add_argument(
            '--dry-run',
            action='store_true',
            help='è¯•è¿è¡Œï¼Œä¸å®é™…ä¿®æ”¹æ–‡ä»¶'
        )
        parser.add_argument(
            '--export-config',
            help='å¯¼å‡ºå½“å‰é…ç½®åˆ°æ–‡ä»¶'
        )

        return parser

    def run(self, args=None) -> int:
        """è¿è¡Œå‘½ä»¤è¡Œå·¥å…·"""
        args = self.parser.parse_args(args)

        try:
            # åŠ è½½æˆ–åˆ›å»ºé…ç½®
            config = self._load_config(args)

            # å¯¼å‡ºé…ç½®ï¼ˆå¦‚æœæŒ‡å®šï¼‰
            if args.export_config:
                self._export_config(config, args.export_config)
                return 0

            # è¯•è¿è¡Œæ¨¡å¼
            if args.dry_run:
                print("ğŸ” è¯•è¿è¡Œæ¨¡å¼ - ä¸ä¼šä¿®æ”¹ä»»ä½•æ–‡ä»¶")

            # åˆ›å»ºæ··æ·†å¼•æ“
            engine = ObfuscationEngine(config)

            # è¿›åº¦å›è°ƒ
            def progress_callback(progress):
                if not args.quiet:
                    print(f"\rè¿›åº¦: {progress:.1f}%", end='', flush=True)

            # å¼€å§‹æ··æ·†
            if not args.quiet:
                print(f"ğŸš€ å¼€å§‹æ··æ·†é¡¹ç›®: {args.project}")

            result = engine.start_obfuscation(
                callback=progress_callback,
                dry_run=args.dry_run
            )

            if not args.quiet:
                print()  # æ¢è¡Œ

            # è¾“å‡ºç»“æœ
            if result.success:
                self._print_success(result, args.verbose)
                return 0
            else:
                self._print_error(result)
                return 1

        except KeyboardInterrupt:
            print("\nâš ï¸  ç”¨æˆ·ä¸­æ–­")
            return 130
        except Exception as e:
            print(f"âŒ é”™è¯¯: {str(e)}", file=sys.stderr)
            if args.verbose:
                import traceback
                traceback.print_exc()
            return 1

    def _load_config(self, args) -> ObfuscationConfig:
        """åŠ è½½é…ç½®"""
        if args.config:
            # ä»é…ç½®æ–‡ä»¶åŠ è½½
            with open(args.config, 'r', encoding='utf-8') as f:
                config_dict = json.load(f)
            config = ObfuscationConfig.from_dict(config_dict)
        else:
            # ä»å‘½ä»¤è¡Œå‚æ•°åˆ›å»º
            config = ObfuscationConfig(
                project_path=args.project,
                output_path=args.output,
                language=args.language,
                obfuscation={
                    'class_names': args.all or args.class_names,
                    'method_names': args.all or args.method_names,
                    'property_names': args.all or args.property_names,
                    'file_names': args.all or args.file_names,
                    'resource_names': args.all or args.resource_names,
                },
                naming={
                    'strategy': args.strategy,
                    'prefix': args.prefix,
                    'min_length': args.min_length,
                    'max_length': args.max_length,
                },
                garbage_code={
                    'enabled': args.garbage_code,
                },
                string_encryption={
                    'enabled': args.string_encrypt,
                },
                cleanup={
                    'remove_comments': args.remove_comments,
                },
                whitelist_file=args.whitelist,
                backup=not args.no_backup,
            )

        return config

    def _export_config(self, config: ObfuscationConfig, file_path: str):
        """å¯¼å‡ºé…ç½®åˆ°æ–‡ä»¶"""
        config_dict = config.to_dict()
        with open(file_path, 'w', encoding='utf-8') as f:
            json.dump(config_dict, f, indent=2, ensure_ascii=False)
        print(f"âœ… é…ç½®å·²å¯¼å‡ºåˆ°: {file_path}")

    def _print_success(self, result, verbose: bool):
        """æ‰“å°æˆåŠŸä¿¡æ¯"""
        print("âœ… æ··æ·†æˆåŠŸï¼")
        print(f"ğŸ“Š ç»Ÿè®¡ä¿¡æ¯:")
        print(f"   - å¤„ç†æ–‡ä»¶: {result.stats.files_processed}")
        print(f"   - æ··æ·†ç±»: {result.stats.classes_obfuscated}")
        print(f"   - æ··æ·†æ–¹æ³•: {result.stats.methods_obfuscated}")
        print(f"   - æ··æ·†å±æ€§: {result.stats.properties_obfuscated}")
        print(f"   - æ··æ·†èµ„æº: {result.stats.resources_obfuscated}")
        if result.stats.garbage_code_inserted > 0:
            print(f"   - æ’å…¥åƒåœ¾ä»£ç : {result.stats.garbage_code_inserted}")
        if result.stats.strings_encrypted > 0:
            print(f"   - åŠ å¯†å­—ç¬¦ä¸²: {result.stats.strings_encrypted}")
        print(f"   - è€—æ—¶: {result.stats.duration:.2f}ç§’")
        print(f"ğŸ“„ æ˜ å°„è¡¨: {result.mapping_file}")
        print(f"ğŸ“ æ—¥å¿—æ–‡ä»¶: {result.log_file}")

    def _print_error(self, result):
        """æ‰“å°é”™è¯¯ä¿¡æ¯"""
        print(f"âŒ æ··æ·†å¤±è´¥: {result.message}", file=sys.stderr)


def main():
    """å‘½ä»¤è¡Œå…¥å£"""
    cli = ObfuscationCLI()
    sys.exit(cli.run())


if __name__ == '__main__':
    main()
```

#### 4.2.2 ä½¿ç”¨ç¤ºä¾‹

**åŸºæœ¬ä½¿ç”¨**ï¼š
```bash
# æœ€ç®€å•çš„ä½¿ç”¨æ–¹å¼
python3 -m gui.modules.obfuscation.obfuscation_cli \
    -p /path/to/MyApp.xcodeproj \
    -o /path/to/MyApp_obfuscated \
    --all

# æŒ‡å®šå…·ä½“æ··æ·†é€‰é¡¹
python3 -m gui.modules.obfuscation.obfuscation_cli \
    -p /path/to/MyApp.xcodeproj \
    -o /path/to/MyApp_obfuscated \
    --class-names \
    --method-names \
    --property-names
```

**ä½¿ç”¨é…ç½®æ–‡ä»¶**ï¼š
```bash
# åˆ›å»ºé…ç½®æ–‡ä»¶
python3 -m gui.modules.obfuscation.obfuscation_cli \
    -p /path/to/MyApp.xcodeproj \
    -o /path/to/MyApp_obfuscated \
    --all \
    --export-config obfuscate_config.json

# ä½¿ç”¨é…ç½®æ–‡ä»¶
python3 -m gui.modules.obfuscation.obfuscation_cli \
    -c obfuscate_config.json
```

**é«˜çº§åŠŸèƒ½**ï¼š
```bash
# å®Œæ•´åŠŸèƒ½æ··æ·†
python3 -m gui.modules.obfuscation.obfuscation_cli \
    -p /path/to/MyApp.xcodeproj \
    -o /path/to/MyApp_obfuscated \
    -w whitelist.json \
    --all \
    --garbage-code \
    --string-encrypt \
    --remove-comments \
    --strategy random \
    --verbose

# è¯•è¿è¡Œï¼ˆä¸å®é™…ä¿®æ”¹æ–‡ä»¶ï¼‰
python3 -m gui.modules.obfuscation.obfuscation_cli \
    -p /path/to/MyApp.xcodeproj \
    -o /path/to/MyApp_obfuscated \
    --all \
    --dry-run
```

### 4.3 Shellè„šæœ¬å°è£… (scripts/obfuscate.sh)

ä¸ºäº†æ›´æ–¹ä¾¿çš„ä½¿ç”¨ï¼Œæä¾›Shellè„šæœ¬å°è£…ï¼š

```bash
#!/bin/bash
# iOSä»£ç æ··æ·†Shellè„šæœ¬
# ç”¨æ³•: ./scripts/obfuscate.sh <é¡¹ç›®è·¯å¾„> <è¾“å‡ºè·¯å¾„> [é€‰é¡¹]

set -e  # é‡åˆ°é”™è¯¯ç«‹å³é€€å‡º

# è„šæœ¬ç›®å½•
SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
PROJECT_ROOT="$(cd "$SCRIPT_DIR/.." && pwd)"

# é¢œè‰²è¾“å‡º
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
NC='\033[0m' # No Color

# æ—¥å¿—å‡½æ•°
log_info() {
    echo -e "${GREEN}[INFO]${NC} $1"
}

log_warn() {
    echo -e "${YELLOW}[WARN]${NC} $1"
}

log_error() {
    echo -e "${RED}[ERROR]${NC} $1"
}

# æ£€æŸ¥Pythonç¯å¢ƒ
check_python() {
    if ! command -v python3 &> /dev/null; then
        log_error "Python 3 æœªå®‰è£…"
        exit 1
    fi

    # æ£€æŸ¥è™šæ‹Ÿç¯å¢ƒ
    if [ ! -d "$PROJECT_ROOT/venv" ]; then
        log_warn "è™šæ‹Ÿç¯å¢ƒä¸å­˜åœ¨ï¼Œæ­£åœ¨åˆ›å»º..."
        python3 -m venv "$PROJECT_ROOT/venv"
    fi

    # æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
    source "$PROJECT_ROOT/venv/bin/activate"

    # å®‰è£…ä¾èµ–
    if ! python3 -c "import gui.modules.obfuscation" &> /dev/null; then
        log_warn "æ­£åœ¨å®‰è£…ä¾èµ–..."
        pip install -r "$PROJECT_ROOT/requirements.txt" -q
    fi
}

# æ˜¾ç¤ºå¸®åŠ©
show_help() {
    cat << EOF
iOSä»£ç æ··æ·†å·¥å…·

ç”¨æ³•:
    $0 <é¡¹ç›®è·¯å¾„> <è¾“å‡ºè·¯å¾„> [é€‰é¡¹]

ç¤ºä¾‹:
    # åŸºæœ¬ä½¿ç”¨
    $0 /path/to/MyApp.xcodeproj /path/to/output --all

    # ä½¿ç”¨é…ç½®æ–‡ä»¶
    $0 --config obfuscate_config.json

    # æŒ‡å®šç™½åå•
    $0 /path/to/MyApp.xcodeproj /path/to/output \\
        --all --whitelist whitelist.json

    # å®Œæ•´åŠŸèƒ½
    $0 /path/to/MyApp.xcodeproj /path/to/output \\
        --all --garbage-code --string-encrypt --remove-comments

é€‰é¡¹:
    --config FILE          ä½¿ç”¨é…ç½®æ–‡ä»¶
    --whitelist FILE       ä½¿ç”¨ç™½åå•æ–‡ä»¶
    --all                  å¯ç”¨æ‰€æœ‰æ··æ·†é€‰é¡¹
    --class-names          æ··æ·†ç±»å
    --method-names         æ··æ·†æ–¹æ³•å
    --property-names       æ··æ·†å±æ€§å
    --file-names           æ··æ·†æ–‡ä»¶å
    --resource-names       æ··æ·†èµ„æºæ–‡ä»¶å
    --garbage-code         æ’å…¥åƒåœ¾ä»£ç 
    --string-encrypt       åŠ å¯†å­—ç¬¦ä¸²
    --remove-comments      ç§»é™¤æ³¨é‡Š
    --strategy STRATEGY    å‘½åç­–ç•¥ (random/prefix/pattern/dictionary)
    --no-backup            ä¸åˆ›å»ºå¤‡ä»½
    --verbose              è¯¦ç»†è¾“å‡º
    --quiet                å®‰é™æ¨¡å¼
    --dry-run              è¯•è¿è¡Œ
    --help                 æ˜¾ç¤ºå¸®åŠ©

EOF
}

# ä¸»å‡½æ•°
main() {
    # æ£€æŸ¥å‚æ•°
    if [ $# -eq 0 ] || [ "$1" = "--help" ] || [ "$1" = "-h" ]; then
        show_help
        exit 0
    fi

    log_info "åˆå§‹åŒ–ç¯å¢ƒ..."
    check_python

    log_info "å¯åŠ¨æ··æ·†..."

    # è°ƒç”¨Python CLI
    python3 -m gui.modules.obfuscation.obfuscation_cli "$@"

    # æ£€æŸ¥è¿”å›å€¼
    if [ $? -eq 0 ]; then
        log_info "æ··æ·†å®Œæˆï¼"
    else
        log_error "æ··æ·†å¤±è´¥ï¼"
        exit 1
    fi
}

# æ‰§è¡Œ
main "$@"
```

**ä½¿ç”¨æ–¹æ³•**ï¼š
```bash
# æ·»åŠ æ‰§è¡Œæƒé™
chmod +x scripts/obfuscate.sh

# åŸºæœ¬ä½¿ç”¨
./scripts/obfuscate.sh /path/to/MyApp.xcodeproj /path/to/output --all

# ä½¿ç”¨é…ç½®æ–‡ä»¶
./scripts/obfuscate.sh --config obfuscate_config.json
```

### 4.4 Python CLIå…¥å£ (scripts/obfuscate.py)

æä¾›ç‹¬ç«‹çš„Pythonè„šæœ¬å…¥å£ï¼š

```python
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
iOSä»£ç æ··æ·†Python CLIå…¥å£
ç‹¬ç«‹è„šæœ¬ï¼Œå¯ç›´æ¥è¿è¡Œ
"""

import sys
import os

# æ·»åŠ é¡¹ç›®æ ¹ç›®å½•åˆ°Pythonè·¯å¾„
script_dir = os.path.dirname(os.path.abspath(__file__))
project_root = os.path.dirname(script_dir)
sys.path.insert(0, project_root)

# å¯¼å…¥CLI
from gui.modules.obfuscation.obfuscation_cli import main

if __name__ == '__main__':
    main()
```

**ä½¿ç”¨æ–¹æ³•**ï¼š
```bash
# æ·»åŠ æ‰§è¡Œæƒé™
chmod +x scripts/obfuscate.py

# ç›´æ¥è¿è¡Œ
./scripts/obfuscate.py -p /path/to/project -o /path/to/output --all
```

### 4.5 Jenkinsé›†æˆ

#### 4.5.1 Jenkinsfileç¤ºä¾‹

```groovy
pipeline {
    agent any

    environment {
        PROJECT_PATH = '/path/to/MyApp.xcodeproj'
        OUTPUT_PATH = "${WORKSPACE}/obfuscated"
        OBFUSCATE_CONFIG = "${WORKSPACE}/obfuscate_config.json"
    }

    stages {
        stage('Checkout') {
            steps {
                // æ£€å‡ºä»£ç 
                checkout scm
            }
        }

        stage('Setup') {
            steps {
                sh '''
                    # åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
                    python3 -m venv venv
                    source venv/bin/activate

                    # å®‰è£…ä¾èµ–
                    pip install -r requirements.txt
                '''
            }
        }

        stage('Obfuscate') {
            steps {
                sh '''
                    source venv/bin/activate

                    # æ‰§è¡Œæ··æ·†
                    python3 -m gui.modules.obfuscation.obfuscation_cli \
                        -p ${PROJECT_PATH} \
                        -o ${OUTPUT_PATH} \
                        -c ${OBFUSCATE_CONFIG} \
                        --verbose
                '''
            }
        }

        stage('Build') {
            steps {
                sh '''
                    # æ„å»ºæ··æ·†åçš„é¡¹ç›®
                    cd ${OUTPUT_PATH}
                    xcodebuild -project MyApp.xcodeproj \
                        -scheme MyApp \
                        -configuration Release \
                        clean build
                '''
            }
        }

        stage('Archive') {
            steps {
                // å½’æ¡£æ··æ·†æ˜ å°„è¡¨
                archiveArtifacts artifacts: '**/obfuscation_mapping.json', fingerprint: true

                // å½’æ¡£æ··æ·†æ—¥å¿—
                archiveArtifacts artifacts: '**/obfuscation.log', fingerprint: true

                // å½’æ¡£IPA
                archiveArtifacts artifacts: '**/*.ipa', fingerprint: true
            }
        }
    }

    post {
        always {
            // æ¸…ç†å·¥ä½œç©ºé—´
            cleanWs()
        }
        success {
            echo 'âœ… æ··æ·†å’Œæ„å»ºæˆåŠŸï¼'
        }
        failure {
            echo 'âŒ æ··æ·†æˆ–æ„å»ºå¤±è´¥ï¼'
        }
    }
}
```

#### 4.5.2 é…ç½®æ–‡ä»¶æ¨¡æ¿

åˆ›å»º `obfuscate_config.json` é…ç½®æ–‡ä»¶ï¼š

```json
{
    "project_path": "${PROJECT_PATH}",
    "output_path": "${OUTPUT_PATH}",
    "language": "both",

    "obfuscation": {
        "class_names": true,
        "method_names": true,
        "property_names": true,
        "file_names": true,
        "resource_names": true
    },

    "naming": {
        "strategy": "random",
        "prefix": "XY_",
        "min_length": 8,
        "max_length": 16
    },

    "garbage_code": {
        "enabled": true,
        "methods_per_class": 5,
        "properties_per_class": 3
    },

    "string_encryption": {
        "enabled": true,
        "algorithm": "base64",
        "exclude_short": true,
        "min_length": 3
    },

    "cleanup": {
        "remove_comments": true,
        "remove_whitespace": false
    },

    "whitelist_file": "./whitelist.json",
    "backup": true
}
```

### 4.6 GitLab CI/CDé›†æˆ

#### 4.6.1 .gitlab-ci.ymlç¤ºä¾‹

```yaml
stages:
  - setup
  - obfuscate
  - build
  - deploy

variables:
  PROJECT_PATH: "/path/to/MyApp.xcodeproj"
  OUTPUT_PATH: "$CI_PROJECT_DIR/obfuscated"

setup:
  stage: setup
  script:
    - python3 -m venv venv
    - source venv/bin/activate
    - pip install -r requirements.txt
  artifacts:
    paths:
      - venv/
    expire_in: 1 hour

obfuscate:
  stage: obfuscate
  dependencies:
    - setup
  script:
    - source venv/bin/activate
    - |
      python3 -m gui.modules.obfuscation.obfuscation_cli \
        -p $PROJECT_PATH \
        -o $OUTPUT_PATH \
        -c obfuscate_config.json \
        --verbose
  artifacts:
    paths:
      - obfuscated/
      - obfuscation_mapping.json
      - obfuscation.log
    expire_in: 1 week

build:
  stage: build
  dependencies:
    - obfuscate
  script:
    - cd $OUTPUT_PATH
    - xcodebuild -project MyApp.xcodeproj -scheme MyApp -configuration Release clean build
  artifacts:
    paths:
      - "**/*.ipa"
    expire_in: 1 month

deploy:
  stage: deploy
  dependencies:
    - build
  script:
    - echo "éƒ¨ç½²åˆ°App Storeæˆ–ä¼ä¸šåˆ†å‘å¹³å°"
  only:
    - main
```

### 4.7 GitHub Actionsé›†æˆ

#### 4.7.1 workflowç¤ºä¾‹

åˆ›å»º `.github/workflows/obfuscate-and-build.yml`ï¼š

```yaml
name: Obfuscate and Build

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main ]
  workflow_dispatch:

jobs:
  obfuscate:
    runs-on: macos-latest

    steps:
    - name: Checkout code
      uses: actions/checkout@v3

    - name: Setup Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.9'

    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install -r requirements.txt

    - name: Run obfuscation
      run: |
        python -m gui.modules.obfuscation.obfuscation_cli \
          -p /path/to/MyApp.xcodeproj \
          -o ./obfuscated \
          -c obfuscate_config.json \
          --verbose

    - name: Upload obfuscation mapping
      uses: actions/upload-artifact@v3
      with:
        name: obfuscation-mapping
        path: obfuscation_mapping.json

    - name: Upload obfuscation log
      uses: actions/upload-artifact@v3
      with:
        name: obfuscation-log
        path: obfuscation.log

    - name: Build project
      run: |
        cd obfuscated
        xcodebuild -project MyApp.xcodeproj \
          -scheme MyApp \
          -configuration Release \
          clean build

    - name: Upload IPA
      uses: actions/upload-artifact@v3
      with:
        name: app-ipa
        path: "**/*.ipa"
```

### 4.8 æœ¬åœ°è°ƒè¯•è„šæœ¬ç¤ºä¾‹

#### 4.8.1 å¿«é€Ÿæ··æ·†è„šæœ¬

åˆ›å»º `quick_obfuscate.sh` ç”¨äºæœ¬åœ°å¿«é€Ÿæµ‹è¯•ï¼š

```bash
#!/bin/bash
# å¿«é€Ÿæ··æ·†è„šæœ¬ - ç”¨äºæœ¬åœ°å¼€å‘è°ƒè¯•

PROJECT_PATH="/path/to/MyApp.xcodeproj"
OUTPUT_PATH="./obfuscated_$(date +%Y%m%d_%H%M%S)"

echo "ğŸš€ å¼€å§‹å¿«é€Ÿæ··æ·†..."
echo "é¡¹ç›®: $PROJECT_PATH"
echo "è¾“å‡º: $OUTPUT_PATH"

# æ‰§è¡Œæ··æ·†
./scripts/obfuscate.sh \
    "$PROJECT_PATH" \
    "$OUTPUT_PATH" \
    --all \
    --garbage-code \
    --string-encrypt \
    --verbose

# æ£€æŸ¥ç»“æœ
if [ $? -eq 0 ]; then
    echo "âœ… æ··æ·†æˆåŠŸï¼"
    echo "ğŸ“ è¾“å‡ºç›®å½•: $OUTPUT_PATH"

    # å¯é€‰ï¼šè‡ªåŠ¨æ‰“å¼€è¾“å‡ºç›®å½•
    open "$OUTPUT_PATH"
else
    echo "âŒ æ··æ·†å¤±è´¥ï¼"
    exit 1
fi
```

#### 4.8.2 æ‰¹é‡æ··æ·†è„šæœ¬

åˆ›å»º `batch_obfuscate.sh` ç”¨äºæ‰¹é‡å¤„ç†å¤šä¸ªé¡¹ç›®ï¼š

```bash
#!/bin/bash
# æ‰¹é‡æ··æ·†è„šæœ¬

# é¡¹ç›®åˆ—è¡¨
PROJECTS=(
    "/path/to/Project1.xcodeproj"
    "/path/to/Project2.xcodeproj"
    "/path/to/Project3.xcodeproj"
)

OUTPUT_ROOT="./obfuscated_batch_$(date +%Y%m%d_%H%M%S)"
mkdir -p "$OUTPUT_ROOT"

echo "ğŸš€ å¼€å§‹æ‰¹é‡æ··æ·† ${#PROJECTS[@]} ä¸ªé¡¹ç›®..."

for PROJECT in "${PROJECTS[@]}"; do
    PROJECT_NAME=$(basename "$PROJECT" .xcodeproj)
    OUTPUT_PATH="$OUTPUT_ROOT/$PROJECT_NAME"

    echo ""
    echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
    echo "æ··æ·†é¡¹ç›®: $PROJECT_NAME"
    echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"

    ./scripts/obfuscate.sh \
        "$PROJECT" \
        "$OUTPUT_PATH" \
        --all \
        --garbage-code \
        --string-encrypt

    if [ $? -eq 0 ]; then
        echo "âœ… $PROJECT_NAME æ··æ·†æˆåŠŸ"
    else
        echo "âŒ $PROJECT_NAME æ··æ·†å¤±è´¥"
    fi
done

echo ""
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "âœ… æ‰¹é‡æ··æ·†å®Œæˆï¼"
echo "ğŸ“ è¾“å‡ºç›®å½•: $OUTPUT_ROOT"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
```

### 4.9 è¿”å›ç å®šä¹‰

ä¸ºäº†ä¾¿äºCI/CDé›†æˆï¼Œå®šä¹‰æ ‡å‡†è¿”å›ç ï¼š

```python
class ExitCode:
    """å‘½ä»¤è¡Œå·¥å…·è¿”å›ç """
    SUCCESS = 0              # æˆåŠŸ
    GENERAL_ERROR = 1        # ä¸€èˆ¬é”™è¯¯
    INVALID_ARGS = 2         # æ— æ•ˆå‚æ•°
    PROJECT_NOT_FOUND = 3    # é¡¹ç›®ä¸å­˜åœ¨
    CONFIG_ERROR = 4         # é…ç½®é”™è¯¯
    PARSE_ERROR = 5          # è§£æé”™è¯¯
    TRANSFORM_ERROR = 6      # è½¬æ¢é”™è¯¯
    IO_ERROR = 7             # æ–‡ä»¶æ“ä½œé”™è¯¯
    USER_INTERRUPT = 130     # ç”¨æˆ·ä¸­æ–­ (Ctrl+C)
```

### 4.10 æ—¥å¿—è¾“å‡ºæ ¼å¼

ä¸ºä¾¿äºCI/CDè§£æï¼Œæä¾›ç»“æ„åŒ–æ—¥å¿—è¾“å‡ºï¼š

```python
import logging
import json

class StructuredLogger:
    """ç»“æ„åŒ–æ—¥å¿—è®°å½•å™¨"""

    def __init__(self, log_file: str = None):
        self.log_file = log_file
        self.events = []

    def log_event(self, event_type: str, data: dict):
        """è®°å½•äº‹ä»¶"""
        event = {
            'timestamp': datetime.now().isoformat(),
            'type': event_type,
            'data': data
        }
        self.events.append(event)

        if self.log_file:
            with open(self.log_file, 'a') as f:
                f.write(json.dumps(event) + '\n')

    def get_summary(self) -> dict:
        """è·å–æ‘˜è¦"""
        return {
            'total_events': len(self.events),
            'events_by_type': self._count_by_type(),
            'duration': self._calculate_duration()
        }

    def _count_by_type(self) -> dict:
        """æŒ‰ç±»å‹ç»Ÿè®¡äº‹ä»¶"""
        counts = {}
        for event in self.events:
            event_type = event['type']
            counts[event_type] = counts.get(event_type, 0) + 1
        return counts
```

---

## äº”ã€æŠ€æœ¯å®ç°ç»†èŠ‚

### 4.1 Objective-Cä»£ç è§£æ

**ç±»åæå–**ï¼š
```python
# æå–@interfaceå®šä¹‰
class_pattern = r'@interface\s+(\w+)\s*:\s*(\w+)'

# æå–@implementationå®šä¹‰
impl_pattern = r'@implementation\s+(\w+)'

# æå–Category
category_pattern = r'@interface\s+(\w+)\s*\((\w+)\)'
```

**æ–¹æ³•åæå–**ï¼š
```python
# å®ä¾‹æ–¹æ³•
instance_method_pattern = r'^\s*-\s*\(([\w\s\*]+)\)\s*(\w+)'

# ç±»æ–¹æ³•
class_method_pattern = r'^\s*\+\s*\(([\w\s\*]+)\)\s*(\w+)'

# å¸¦å‚æ•°çš„æ–¹æ³•
parameterized_method_pattern = r'(\w+):\s*\([\w\s\*]+\)\s*\w+'
```

**å±æ€§åæå–**ï¼š
```python
# @propertyå£°æ˜
property_pattern = r'@property\s*\([^)]*\)\s*([\w\s\*]+)\s+(\w+)'

# å®ä¾‹å˜é‡
ivar_pattern = r'\{\s*([\w\s\*]+)\s+(\w+)\s*;'
```

### 4.2 Swiftä»£ç è§£æ

**ç±»åæå–**ï¼š
```python
# classå®šä¹‰
class_pattern = r'class\s+(\w+)\s*:\s*([\w\s,]+)?'

# structå®šä¹‰
struct_pattern = r'struct\s+(\w+)\s*:\s*([\w\s,]+)?'

# extensionå®šä¹‰
extension_pattern = r'extension\s+(\w+)'
```

**æ–¹æ³•åæå–**ï¼š
```python
# å‡½æ•°å®šä¹‰
func_pattern = r'func\s+(\w+)\s*\('

# initæ–¹æ³•
init_pattern = r'init\s*\('
```

**å±æ€§åæå–**ï¼š
```python
# å˜é‡å£°æ˜
var_pattern = r'var\s+(\w+)\s*:\s*([\w\?!]+)'

# å¸¸é‡å£°æ˜
let_pattern = r'let\s+(\w+)\s*:\s*([\w\?!]+)'
```

### 4.3 åç§°ç”Ÿæˆç®—æ³•

**éšæœºå‘½å**ï¼š
```python
import random
import string

def generate_random_name(prefix='', length=10):
    """ç”Ÿæˆéšæœºåç§°"""
    chars = string.ascii_letters
    name = prefix + ''.join(random.choice(chars) for _ in range(length))
    # ç¡®ä¿é¦–å­—æ¯å¤§å†™ï¼ˆç±»åï¼‰
    return name[0].upper() + name[1:]
```

**æ¨¡å¼å‘½å**ï¼š
```python
def generate_pattern_name(pattern='CapitalWord'):
    """ç”Ÿæˆæ¨¡å¼åç§°"""
    syllables = ['Ab', 'Cd', 'Ef', 'Gh', 'Ij', 'Kl', 'Mn']
    name = ''.join(random.sample(syllables, 3))
    return name
```

**è¯å…¸å‘½å**ï¼š
```python
def generate_dictionary_name(word_list):
    """ä½¿ç”¨çœŸå®å•è¯ç”Ÿæˆåç§°"""
    words = random.sample(word_list, 2)
    return ''.join(word.capitalize() for word in words)
```

### 4.4 ä»£ç æ›¿æ¢ç­–ç•¥

**å¤šé˜¶æ®µæ›¿æ¢**ï¼š
```python
def transform_code(content, mappings):
    """å¤šé˜¶æ®µä»£ç è½¬æ¢"""

    # ç¬¬1é˜¶æ®µï¼šæ›¿æ¢ç±»åï¼ˆæœ€é•¿çš„å…ˆæ›¿æ¢ï¼‰
    for old_name, new_name in sorted(mappings.class_mappings.items(),
                                      key=lambda x: len(x[0]),
                                      reverse=True):
        content = replace_with_word_boundary(content, old_name, new_name)

    # ç¬¬2é˜¶æ®µï¼šæ›¿æ¢æ–¹æ³•å
    for old_name, new_name in mappings.method_mappings.items():
        content = replace_method_name(content, old_name, new_name)

    # ç¬¬3é˜¶æ®µï¼šæ›¿æ¢å±æ€§å
    for old_name, new_name in mappings.property_mappings.items():
        content = replace_property_name(content, old_name, new_name)

    return content

def replace_with_word_boundary(content, old_name, new_name):
    """ä½¿ç”¨å•è¯è¾¹ç•Œæ›¿æ¢ï¼ˆé¿å…è¯¯æ›¿æ¢ï¼‰"""
    pattern = r'\b' + re.escape(old_name) + r'\b'
    return re.sub(pattern, new_name, content)
```

### 4.5 åƒåœ¾ä»£ç æ¨¡æ¿

**Objective-Cåƒåœ¾æ–¹æ³•**ï¼š
```objc
- (void)garbageMethod{random_suffix} {
    NSInteger var1 = arc4random() % 100;
    NSInteger var2 = arc4random() % 100;
    NSInteger result = var1 + var2;

    if (result > 50) {
        NSLog(@"Result: %ld", (long)result);
    } else {
        NSLog(@"Result: %ld", (long)result);
    }
}
```

**Swiftåƒåœ¾æ–¹æ³•**ï¼š
```swift
func garbageMethod{random_suffix}() {
    let var1 = Int.random(in: 0..<100)
    let var2 = Int.random(in: 0..<100)
    let result = var1 + var2

    if result > 50 {
        print("Result: \(result)")
    } else {
        print("Result: \(result)")
    }
}
```

### 4.6 å­—ç¬¦ä¸²åŠ å¯†

**Base64åŠ å¯†**ï¼š
```python
import base64

def encrypt_string(text):
    """Base64åŠ å¯†"""
    encoded = base64.b64encode(text.encode('utf-8')).decode('utf-8')
    return encoded

def generate_decrypt_function_objc():
    """ç”ŸæˆOCè§£å¯†å‡½æ•°"""
    return '''
- (NSString *)decryptString:(NSString *)encrypted {
    NSData *data = [[NSData alloc] initWithBase64EncodedString:encrypted options:0];
    return [[NSString alloc] initWithData:data encoding:NSUTF8StringEncoding];
}
'''

def replace_string_literal(content):
    """æ›¿æ¢å­—ç¬¦ä¸²å­—é¢é‡"""
    pattern = r'@"([^"]+)"'

    def replacer(match):
        original = match.group(1)
        encrypted = encrypt_string(original)
        return f'[self decryptString:@"{encrypted}"]'

    return re.sub(pattern, replacer, content)
```

**XORåŠ å¯†**ï¼š
```python
def xor_encrypt(text, key=0x5A):
    """XORåŠ å¯†"""
    encrypted = ''.join(chr(ord(c) ^ key) for c in text)
    return base64.b64encode(encrypted.encode()).decode()

def generate_xor_decrypt_function():
    """ç”ŸæˆXORè§£å¯†å‡½æ•°"""
    return '''
- (NSString *)decryptXOR:(NSString *)encrypted {
    NSData *data = [[NSData alloc] initWithBase64EncodedString:encrypted options:0];
    NSMutableData *decrypted = [data mutableCopy];
    uint8_t *bytes = decrypted.mutableBytes;
    for (NSInteger i = 0; i < decrypted.length; i++) {
        bytes[i] ^= 0x5A;
    }
    return [[NSString alloc] initWithData:decrypted encoding:NSUTF8StringEncoding];
}
'''
```

---

## äº”ã€å®æ–½è®¡åˆ’

### 5.1 å¼€å‘é˜¶æ®µ

#### ç¬¬ä¸€é˜¶æ®µï¼šåŸºç¡€æ¡†æ¶ï¼ˆ1-2å¤©ï¼‰
- [x] åˆ›å»ºæ¨¡å—ç›®å½•ç»“æ„
- [ ] å®ç°é¡¹ç›®åˆ†æå™¨ (project_analyzer.py)
- [ ] å®ç°é…ç½®ç®¡ç†å™¨ (config_manager.py)
- [ ] å®ç°ç™½åå•ç®¡ç†å™¨ (whitelist_manager.py)
- [ ] å®ç°åç§°ç”Ÿæˆå™¨ (name_generator.py)
- [ ] åˆ›å»ºGUIåŸºç¡€ç•Œé¢ (obfuscation_tab.py)

#### ç¬¬äºŒé˜¶æ®µï¼šæ ¸å¿ƒåŠŸèƒ½ï¼ˆ2-3å¤©ï¼‰
- [ ] å®ç°ä»£ç è§£æå™¨ (code_parser.py)
  - [ ] Objective-Cè§£æ
  - [ ] Swiftè§£æ
- [ ] å®ç°ä»£ç è½¬æ¢å™¨ (code_transformer.py)
  - [ ] ç±»åæ›¿æ¢
  - [ ] æ–¹æ³•åæ›¿æ¢
  - [ ] å±æ€§åæ›¿æ¢
- [ ] å®ç°èµ„æºå¤„ç†å™¨ (resource_handler.py)
  - [ ] å›¾ç‰‡æ–‡ä»¶é‡å‘½å
  - [ ] ä»£ç å¼•ç”¨åŒæ­¥

#### ç¬¬ä¸‰é˜¶æ®µï¼šé«˜çº§åŠŸèƒ½ï¼ˆ1-2å¤©ï¼‰
- [ ] å®ç°åƒåœ¾ä»£ç ç”Ÿæˆå™¨ (garbage_generator.py)
- [ ] å®ç°å­—ç¬¦ä¸²åŠ å¯†å™¨ (string_encryptor.py)
- [ ] å®ç°æ··æ·†å¼•æ“ (obfuscation_engine.py)
- [ ] å®Œå–„GUIç•Œé¢åŠŸèƒ½

#### ç¬¬å››é˜¶æ®µï¼šæµ‹è¯•å’Œä¼˜åŒ–ï¼ˆ1-2å¤©ï¼‰
- [ ] å•å…ƒæµ‹è¯•
- [ ] é›†æˆæµ‹è¯•
- [ ] æ€§èƒ½ä¼˜åŒ–
- [ ] æ–‡æ¡£å®Œå–„

### 5.2 æµ‹è¯•è®¡åˆ’

#### å•å…ƒæµ‹è¯•
```python
# tests/test_name_generator.py
def test_generate_class_name():
    generator = NameGenerator()
    name = generator.generate_class_name()
    assert len(name) >= 8
    assert name[0].isupper()
    assert name.isalnum()

# tests/test_code_parser.py
def test_parse_objc_class():
    parser = CodeParser()
    code = '''
    @interface MyClass : NSObject
    @property (nonatomic, strong) NSString *name;
    - (void)myMethod;
    @end
    '''
    parsed = parser.parse_objc_code(code)
    assert len(parsed.classes) == 1
    assert parsed.classes[0].name == 'MyClass'
```

#### é›†æˆæµ‹è¯•
```python
# tests/test_obfuscation_engine.py
def test_obfuscate_simple_project():
    engine = ObfuscationEngine(test_config)
    result = engine.start_obfuscation()
    assert result.success
    assert result.stats.classes_obfuscated > 0
```

### 5.3 éƒ¨ç½²è®¡åˆ’

#### é›†æˆåˆ°ä¸»ç¨‹åº
1. åœ¨`gui/mars_log_analyzer_modular.py`ä¸­æ·»åŠ æ–°æ ‡ç­¾é¡µ
2. å¯¼å…¥`obfuscation_tab.py`
3. åˆ›å»º"iOSæ··æ·†"æ ‡ç­¾é¡µå®ä¾‹
4. æµ‹è¯•æ ‡ç­¾é¡µåˆ‡æ¢å’ŒåŠŸèƒ½

#### æ–‡æ¡£æ›´æ–°
1. æ›´æ–°ä¸»`CLAUDE.md`
2. åˆ›å»ºæ¨¡å—`CLAUDE.md`
3. æ›´æ–°`README_CN.md`
4. æ·»åŠ ä½¿ç”¨ç¤ºä¾‹

---

## å…­ã€é£é™©å’Œé™åˆ¶

### 6.1 æŠ€æœ¯é£é™©

**é£é™©1ï¼šä»£ç è§£æä¸å®Œæ•´**
- **é—®é¢˜**ï¼šæ­£åˆ™è¡¨è¾¾å¼å¯èƒ½æ— æ³•å¤„ç†æ‰€æœ‰è¯­æ³•æƒ…å†µ
- **ç¼“è§£**ï¼šé€æ­¥å®Œå–„æ­£åˆ™è§„åˆ™ï¼Œæ·»åŠ ç‰¹æ®Šæƒ…å†µå¤„ç†
- **å¤‡é€‰æ–¹æ¡ˆ**ï¼šä½¿ç”¨clang ASTæˆ–SwiftSyntaxè¿›è¡Œæ›´ç²¾ç¡®çš„è§£æ

**é£é™©2ï¼šæ··æ·†åç¼–è¯‘å¤±è´¥**
- **é—®é¢˜**ï¼šåç§°æ›¿æ¢å¯èƒ½å¯¼è‡´ç¼–è¯‘é”™è¯¯
- **ç¼“è§£**ï¼šå®Œå–„ç™½åå•æœºåˆ¶ï¼Œæµ‹è¯•æ›´å¤šé¡¹ç›®
- **å¤‡é€‰æ–¹æ¡ˆ**ï¼šæä¾›å›æ»šåŠŸèƒ½

**é£é™©3ï¼šæ€§èƒ½é—®é¢˜**
- **é—®é¢˜**ï¼šå¤§å‹é¡¹ç›®å¤„ç†ç¼“æ…¢
- **ç¼“è§£**ï¼šä½¿ç”¨å¤šçº¿ç¨‹å¤„ç†ï¼Œä¼˜åŒ–ç®—æ³•
- **å¤‡é€‰æ–¹æ¡ˆ**ï¼šåˆ†æ‰¹å¤„ç†æ–‡ä»¶

### 6.2 åŠŸèƒ½é™åˆ¶

**å½“å‰ç‰ˆæœ¬é™åˆ¶**ï¼š
1. ä»…æ”¯æŒiOSåŸç”Ÿé¡¹ç›®ï¼ˆObjective-C/Swiftï¼‰
2. ä¸æ”¯æŒè·¨å¹³å°æ¡†æ¶ï¼ˆFlutterã€Unity3Dã€React Nativeï¼‰
3. ä¸æ”¯æŒC++æ··æ·†ï¼ˆæ¸¸æˆå¼•æ“ï¼‰
4. ä¸æ”¯æŒå‡½æ•°æ‹†åˆ†ç­‰é«˜çº§åŠŸèƒ½
5. ç™½åå•éœ€è¦æ‰‹åŠ¨é…ç½®

**æœªæ¥æ‰©å±•æ–¹å‘**ï¼š
1. æ”¯æŒæ›´å¤šè¯­è¨€å’Œæ¡†æ¶
2. AIè¾…åŠ©ç™½åå•ç”Ÿæˆ
3. æ™ºèƒ½è¯†åˆ«ç³»ç»ŸAPI
4. äº‘ç«¯æ··æ·†æœåŠ¡
5. ç‰ˆæœ¬å¯¹æ¯”å’Œå¢é‡æ··æ·†

---

## ä¸ƒã€ä½¿ç”¨ç¤ºä¾‹

### 7.1 åŸºæœ¬ä½¿ç”¨æµç¨‹

```python
# 1. åˆ›å»ºé…ç½®
config = ObfuscationConfig(
    project_path='/path/to/MyApp.xcodeproj',
    output_path='/path/to/MyApp_obfuscated',
    language='objc',
    obfuscation={
        'class_names': True,
        'method_names': True,
        'property_names': True
    }
)

# 2. åˆå§‹åŒ–å¼•æ“
engine = ObfuscationEngine(config)

# 3. å¼€å§‹æ··æ·†
result = engine.start_obfuscation(
    callback=lambda progress: print(f"Progress: {progress}%")
)

# 4. æŸ¥çœ‹ç»“æœ
if result.success:
    print(f"æ··æ·†æˆåŠŸï¼")
    print(f"å¤„ç†æ–‡ä»¶: {result.stats.files_processed}")
    print(f"æ··æ·†ç±»: {result.stats.classes_obfuscated}")
    print(f"æ˜ å°„è¡¨: {result.mapping_file}")
else:
    print(f"æ··æ·†å¤±è´¥: {result.message}")
```

### 7.2 GUIä½¿ç”¨æµç¨‹

1. æ‰“å¼€"iOSæ··æ·†"æ ‡ç­¾é¡µ
2. é€‰æ‹©é¡¹ç›®è·¯å¾„ï¼ˆ.xcodeprojæˆ–.xcworkspaceï¼‰
3. é€‰æ‹©è¾“å‡ºè·¯å¾„
4. é…ç½®æ··æ·†é€‰é¡¹ï¼ˆå‹¾é€‰éœ€è¦çš„åŠŸèƒ½ï¼‰
5. é€‰æ‹©å‘½åç­–ç•¥å’Œå‚æ•°
6. åŠ è½½æˆ–ç¼–è¾‘ç™½åå•é…ç½®
7. ç‚¹å‡»"å¼€å§‹æ··æ·†"
8. æŸ¥çœ‹å®æ—¶è¿›åº¦å’Œæ—¥å¿—
9. æ··æ·†å®ŒæˆåæŸ¥çœ‹ç»“æœå’Œæ˜ å°„è¡¨

---

## å…«ã€é™„å½•

### 8.1 ç³»ç»ŸAPIç™½åå•ï¼ˆéƒ¨åˆ†ï¼‰

**UIKitæ¡†æ¶**ï¼š
```
UIViewController, UIView, UIButton, UILabel, UITableView, UICollectionView,
viewDidLoad, viewWillAppear:, viewDidAppear:, viewWillDisappear:,
tableView:numberOfRowsInSection:, tableView:cellForRowAtIndexPath:,
delegate, dataSource, frame, bounds, center
```

**Foundationæ¡†æ¶**ï¼š
```
NSObject, NSString, NSArray, NSDictionary, NSData, NSError,
init, dealloc, description, isEqual:, hash, copy
```

**Swiftæ ‡å‡†åº“**ï¼š
```
String, Array, Dictionary, Int, Double, Bool,
init, deinit, description
```

### 8.2 æ··æ·†æ˜ å°„è¡¨ç¤ºä¾‹

```json
{
    "timestamp": "2025-10-13T10:30:00",
    "project": "MyApp",
    "version": "1.0.0",

    "mappings": {
        "classes": {
            "ViewController": "Abc123Def",
            "UserModel": "Xyz456Ghi",
            "NetworkManager": "Jkl789Mno"
        },
        "methods": {
            "loadData": "pqr012Stu",
            "saveData:": "vwx345Yza",
            "fetchUserInfo:completion:": "bcd678Efg"
        },
        "properties": {
            "userName": "hij901Klm",
            "userAge": "nop234Qrs"
        },
        "files": {
            "ViewController.h": "Abc123Def.h",
            "ViewController.m": "Abc123Def.m"
        },
        "resources": {
            "icon_home.png": "tuv567Wxy.png",
            "background.jpg": "zab890Cde.jpg"
        }
    }
}
```

### 8.3 å‚è€ƒèµ„æ–™

- **Objective-C Runtime**: https://developer.apple.com/documentation/objectivec/objective-c_runtime
- **Swift Language Guide**: https://docs.swift.org/swift-book/
- **Xcode Project Format**: https://developer.apple.com/documentation/xcode
- **ä»£ç æ··æ·†æœ€ä½³å®è·µ**: å•†ä¸šæ··æ·†è½¯ä»¶æ¡ˆä¾‹ç ”ç©¶

---

## ä¹ã€æ€»ç»“

æœ¬æ–‡æ¡£è¯¦ç»†è®¾è®¡äº†ä¸€ä¸ªiOSä»£ç æ··æ·†åŠŸèƒ½æ¨¡å—ï¼Œä¸»è¦ç‰¹ç‚¹ï¼š

1. **æ¨¡å—åŒ–æ¶æ„** - æ¸…æ™°çš„èŒè´£åˆ†ç¦»ï¼Œä¾¿äºç»´æŠ¤å’Œæ‰©å±•
2. **åŠŸèƒ½å®Œæ•´** - è¦†ç›–æ ¸å¿ƒæ··æ·†éœ€æ±‚ï¼ˆP0/P1ä¼˜å…ˆçº§ï¼‰
3. **å¯æ‰©å±•æ€§** - é¢„ç•™æ¥å£æ”¯æŒæœªæ¥åŠŸèƒ½æ‰©å±•
4. **ç”¨æˆ·å‹å¥½** - ç›´è§‚çš„GUIç•Œé¢å’Œè¯¦ç»†çš„æ—¥å¿—
5. **å®‰å…¨å¯é ** - å¤‡ä»½ã€å›æ»šæœºåˆ¶ä¿è¯å®‰å…¨æ€§

ä¸‹ä¸€æ­¥å°†æŒ‰ç…§å®æ–½è®¡åˆ’é€æ­¥å®ç°å„ä¸ªæ¨¡å—ï¼Œé¦–å…ˆä»åŸºç¡€æ¡†æ¶å¼€å§‹ï¼Œé€æ­¥æ„å»ºæ ¸å¿ƒåŠŸèƒ½ã€‚

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0.0
**æœ€åæ›´æ–°**: 2025-10-13
**ä½œè€…**: Claude Code
**çŠ¶æ€**: è®¾è®¡é˜¶æ®µå®Œæˆï¼Œå¾…å¼€å‘å®æ–½
