# AIåŠ©æ‰‹ä¸æ—¥å¿—æ¨¡å—æ·±åº¦é›†æˆæŒ‡å—

## ğŸ“– æ¦‚è¿°

æœ¬æŒ‡å—ä»‹ç»å¦‚ä½•ä½¿ç”¨å¿ƒå¨±å¼€å‘åŠ©æ‰‹ä¸­æ–°å¢çš„**AIæ™ºèƒ½æ—¥å¿—åˆ†æ**åŠŸèƒ½,å®ç°é«˜æ•ˆçš„é—®é¢˜æ’æŸ¥ã€‚

### ğŸ¯ æ ¸å¿ƒä¼˜åŠ¿

ç›¸æ¯”ä¼ ç»ŸAIåˆ†æ,æ–°ç³»ç»Ÿæä¾›:

| ä¼ ç»Ÿæ–¹å¼ | æ™ºèƒ½é›†æˆæ–¹å¼ | æå‡ |
|---------|------------|------|
| å›ºå®šå‰å5æ¡æ—¥å¿— | æ ¹æ®é—®é¢˜ç±»å‹æ™ºèƒ½è°ƒæ•´ (5-20æ¡) | **3-4å€ä¸Šä¸‹æ–‡è´¨é‡** |
| åˆ†æå•æ¡,æ— å…³è” | ç´¢å¼•æœç´¢ç›¸å…³æ—¥å¿—,è‡ªåŠ¨å…³è” | **å‘ç°éšè—é—®é¢˜** |
| åˆ†æå®Œæ¯•,æ‰‹åŠ¨æŸ¥æ‰¾ | ä¸€é”®è·³è½¬åˆ°æ—¥å¿—ä½ç½®,é—®é¢˜é“¾è·¯è¿½è¸ª | **èŠ‚çœ50%æ’æŸ¥æ—¶é—´** |
| é‡å¤åˆ†æç›¸åŒé—®é¢˜ | æ™ºèƒ½ç¼“å­˜,ç§’çº§å“åº” | **èŠ‚çœAPIæˆæœ¬90%** |

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. åŸºç¡€ä½¿ç”¨æµç¨‹

```
1. åŠ è½½æ—¥å¿—æ–‡ä»¶ â†’ è‡ªåŠ¨æ„å»ºç´¢å¼•
2. é€‰ä¸­é—®é¢˜æ—¥å¿— â†’ å³é”®"ğŸ¤– AIåˆ†ææ­¤æ—¥å¿—"
3. AIè‡ªåŠ¨è¯†åˆ«é—®é¢˜ç±»å‹ â†’ æ™ºèƒ½æå–ä¸Šä¸‹æ–‡ â†’ ç”Ÿæˆåˆ†æ
4. ç‚¹å‡»åˆ†æç»“æœä¸­çš„è¡Œå· â†’ è‡ªåŠ¨è·³è½¬åˆ°ç›¸å…³æ—¥å¿—
5. ä½¿ç”¨å¯¼èˆªå†å² (åé€€/å‰è¿›) â†’ å¿«é€Ÿå›æº¯
```

### 2. å³é”®èœå•åŠŸèƒ½

åœ¨æ—¥å¿—æŸ¥çœ‹å™¨ä¸­é€‰ä¸­ä»»æ„æ—¥å¿—,å³é”®å¯è§:

- **ğŸ¤– AIåˆ†ææ­¤æ—¥å¿—**: æ™ºèƒ½ä¸Šä¸‹æ–‡åˆ†æ (æ¨è)
- **ğŸ¤– AIè§£é‡Šé”™è¯¯åŸå› **: ä¸“æ³¨é”™è¯¯è¯Šæ–­å’Œè§£å†³æ–¹æ¡ˆ
- **ğŸ¤– AIæŸ¥æ‰¾ç›¸å…³æ—¥å¿—**: åˆ©ç”¨ç´¢å¼•æœç´¢æ‰€æœ‰ç›¸å…³æ—¥å¿—

---

## ğŸ’¡ æ ¸å¿ƒåŠŸèƒ½è¯¦è§£

### åŠŸèƒ½1: æ™ºèƒ½ä¸Šä¸‹æ–‡æå–

**ä¼ ç»Ÿæ–¹å¼é—®é¢˜:**
- å›ºå®šæå–å‰åNæ¡æ—¥å¿—,å¯èƒ½é—æ¼å…³é”®ä¿¡æ¯
- å´©æºƒæ—¥å¿—éœ€è¦æ›´å¤šä¸Šä¸‹æ–‡,æ™®é€šæ—¥å¿—ä¸éœ€è¦
- æ— æ³•åŒºåˆ†é‡è¦å’Œæ¬¡è¦æ—¥å¿—

**æ™ºèƒ½æ–¹å¼è§£å†³:**

#### é—®é¢˜ç±»å‹è‡ªåŠ¨è¯†åˆ«

ç³»ç»Ÿè‡ªåŠ¨è¯†åˆ«6ç§é—®é¢˜ç±»å‹,å¹¶è°ƒæ•´ä¸Šä¸‹æ–‡ç­–ç•¥:

| é—®é¢˜ç±»å‹ | æ£€æµ‹å…³é”®è¯ | ä¸Šä¸‹æ–‡èŒƒå›´ | ç‰¹æ®Šå¤„ç† |
|---------|----------|----------|---------|
| ğŸ”¥ å´©æºƒ | `Terminating`, `SIGSEGV`, `Fatal Exception` | å‰15æ¡ + å5æ¡ | åŒçº¿ç¨‹ä¼˜å…ˆ,åŒ…å«æ‰€æœ‰ERROR |
| ğŸ’¾ å†…å­˜ | `OOM`, `Memory`, `leak`, `malloc` | å‰20æ¡ + å5æ¡ | è¿‡æ»¤Memoryå…³é”®è¯ |
| ğŸŒ ç½‘ç»œ | `HTTP`, `timeout`, `connection` | å‰10æ¡ + å10æ¡ | åŒ…å«Request/Response |
| âš¡ æ€§èƒ½ | `ANR`, `slow`, `lag`, `frame drop` | å‰10æ¡ + å5æ¡ | è¿‡æ»¤æ—¶é—´ç›¸å…³è¯ |
| âŒ é”™è¯¯ | `ERROR` çº§åˆ« | å‰5æ¡ + å3æ¡ | æ ‡å‡†ä¸Šä¸‹æ–‡ |
| âš ï¸  è­¦å‘Š | `WARNING` çº§åˆ« | å‰3æ¡ + å2æ¡ | ç²¾ç®€ä¸Šä¸‹æ–‡ |

**ç¤ºä¾‹:**

```python
# åˆ†æå´©æºƒæ—¥å¿—
é€‰ä¸­æ—¥å¿—: "*** Terminating app due to uncaught exception 'NSInvalidArgumentException'"
â†“
è‡ªåŠ¨è¯†åˆ«: é—®é¢˜ç±»å‹ = å´©æºƒ
â†“
æ™ºèƒ½æå–:
  - å‰15æ¡æ—¥å¿— (å¯èƒ½åŒ…å«å´©æºƒå¯¼ç«ç´¢)
  - å5æ¡æ—¥å¿— (å †æ ˆä¿¡æ¯)
  - ä¼˜å…ˆåŒçº¿ç¨‹æ—¥å¿—
  - åŒ…å«æ‰€æœ‰ERRORçº§åˆ«æ—¥å¿—
â†“
AIåˆ†æ: ç»¼åˆä¸Šä¸‹æ–‡,ç»™å‡ºæ ¹å› åˆ†æ
```

#### ä¼˜å…ˆçº§æ’åº

ç³»ç»Ÿå¯¹ä¸Šä¸‹æ–‡æ—¥å¿—è¿›è¡Œæ™ºèƒ½æ’åº:

1. **ERROR/FATAL** çº§åˆ«æ—¥å¿—ä¼˜å…ˆ
2. åŒ…å«**å…³é”®è¯**çš„æ—¥å¿—ä¼˜å…ˆ (æ ¹æ®é—®é¢˜ç±»å‹)
3. **åŒçº¿ç¨‹**æ—¥å¿—ä¼˜å…ˆ (å´©æºƒåˆ†ææ—¶)

**ä»£ç ç¤ºä¾‹:**

```python
from gui.modules.ai_diagnosis.smart_context_extractor import extract_smart_context

# æ™ºèƒ½æå–ä¸Šä¸‹æ–‡
context = extract_smart_context(
    all_entries=log_entries,
    target_entry=selected_log,
    indexer=indexer,  # å¯é€‰,æä¾›ç´¢å¼•åŠ é€Ÿ
    max_tokens=8000   # Tokené™åˆ¶
)

# ç»“æœåŒ…å«:
# - problem_type: é—®é¢˜ç±»å‹ (è‡ªåŠ¨è¯†åˆ«)
# - context_before: ä¼˜åŒ–åçš„å‰ç½®æ—¥å¿—
# - context_after: ä¼˜åŒ–åçš„åç½®æ—¥å¿—
# - related_logs: ç´¢å¼•å…³è”çš„å…¶ä»–æ—¥å¿—
# - summary: ä¸Šä¸‹æ–‡æ‘˜è¦
# - priority_score: ä¼˜å…ˆçº§åˆ†æ•°
```

---

### åŠŸèƒ½2: ç´¢å¼•å…³è”æœç´¢

**ä¼ ç»Ÿæ–¹å¼é—®é¢˜:**
- AIåªèƒ½çœ‹åˆ°å‰åå‡ æ¡æ—¥å¿—,æ— æ³•å…¨å±€å…³è”
- ç›¸å…³é—®é¢˜å¯èƒ½åœ¨å‡ ç™¾è¡Œä¹‹å¤–,æ— æ³•å‘ç°

**æ™ºèƒ½æ–¹å¼è§£å†³:**

åˆ©ç”¨å·²æ„å»ºçš„**å€’æ’ç´¢å¼•**,å¿«é€ŸæŸ¥æ‰¾æ‰€æœ‰ç›¸å…³æ—¥å¿—:

#### å·¥ä½œæµç¨‹

```
1. ä»ç›®æ ‡æ—¥å¿—æå–å…³é”®è¯
   ä¾‹: "Network request failed: timeout" â†’ ["Network", "request", "timeout"]

2. ä½¿ç”¨ç´¢å¼•å¿«é€Ÿæœç´¢
   ç´¢å¼•: {"Network": [10, 25, 100, 500], "timeout": [100, 300]}
   ç»“æœ: [10, 25, 100, 300, 500]

3. æŒ‰æ—¶é—´è·ç¦»æ’åº
   ä¼˜å…ˆè¿”å›æ—¶é—´ä¸Šæ¥è¿‘ç›®æ ‡æ—¥å¿—çš„ç›¸å…³æ—¥å¿—

4. é™åˆ¶æ•°é‡ (Top 10)
   é¿å…Tokenè¿‡å¤š
```

**ç¤ºä¾‹:**

```python
from gui.modules.ai_diagnosis.smart_context_extractor import SmartContextExtractor

extractor = SmartContextExtractor(all_entries, indexer)
context = extractor.extract_context(target_log)

# æŸ¥çœ‹å…³è”æ—¥å¿—
for log in context['related_logs']:
    print(f"è¡Œå·: {log.line_number}, å†…å®¹: {log.content}")

# è¾“å‡º:
# è¡Œå·: 10, å†…å®¹: [ERROR] Network initialization failed
# è¡Œå·: 25, å†…å®¹: [WARNING] Network timeout threshold exceeded
# è¡Œå·: 500, å†…å®¹: [ERROR] Network connection reset
```

**æ€§èƒ½:**
- æ— ç´¢å¼•: æ‰«æå…¨éƒ¨æ—¥å¿—,è€—æ—¶ O(n)
- æœ‰ç´¢å¼•: ç›´æ¥æŸ¥æ‰¾,è€—æ—¶ O(1) ~  O(log n)

å¯¹äº100ä¸‡æ¡æ—¥å¿—:
- æ— ç´¢å¼•: ~2ç§’
- æœ‰ç´¢å¼•: ~10ms (**200å€æå‡**)

---

### åŠŸèƒ½3: AIé©±åŠ¨çš„æ—¥å¿—å¯¼èˆª

**ä¼ ç»Ÿæ–¹å¼é—®é¢˜:**
- AIåˆ†ææåˆ° "ç¬¬100è¡Œæœ‰é—®é¢˜",éœ€è¦æ‰‹åŠ¨æ»šåŠ¨æŸ¥æ‰¾
- åˆ†æå¤šä¸ªé—®é¢˜å,æ— æ³•å¿«é€Ÿå›æº¯

**æ™ºèƒ½æ–¹å¼è§£å†³:**

#### è‡ªåŠ¨è·³è½¬

AIåˆ†æç»“æœä¸­æåˆ°çš„è¡Œå·,è‡ªåŠ¨è§£æå¹¶æ”¯æŒç‚¹å‡»è·³è½¬:

```python
from gui.modules.ai_diagnosis.log_navigator import LogNavigator, AIAnalysisParser

# åˆ›å»ºå¯¼èˆªå™¨
navigator = LogNavigator(log_text_widget, all_entries)

# AIåˆ†æç»“æœ
ai_response = "é—®é¢˜å‡ºç°åœ¨ç¬¬100è¡Œ,å¯¼è‡´ç¬¬200è¡Œå´©æºƒã€‚å»ºè®®æ£€æŸ¥ç¬¬50è¡Œçš„åˆå§‹åŒ–é€»è¾‘ã€‚"

# è‡ªåŠ¨æå–è¡Œå·
line_numbers = AIAnalysisParser.extract_line_numbers(ai_response)
print(line_numbers)  # [100, 200, 50]

# æ ‡è®°å…³é”®æ—¥å¿—
navigator.mark_critical_logs(line_numbers, tag="ai_highlight")

# è·³è½¬åˆ°ç¬¬ä¸€ä¸ªé—®é¢˜
navigator.jump_to_line(100, reason="AIåˆ†æ:é—®é¢˜æ ¹å› ")
```

#### é—®é¢˜é“¾è·¯è¿½è¸ª

å»ºç«‹é—®é¢˜ä¹‹é—´çš„å› æœå…³ç³»,å½¢æˆé—®é¢˜å›¾è°±:

```python
# åˆ›å»ºé—®é¢˜èŠ‚ç‚¹
root_id = navigator.add_problem_node(
    line_number=100,
    problem_type="å´©æºƒ",
    description="ç©ºæŒ‡é’ˆå¼‚å¸¸",
    ai_analysis="ç”¨æˆ·å¯¹è±¡æœªåˆå§‹åŒ–..."
)

cause_id = navigator.add_problem_node(
    line_number=50,
    problem_type="åˆå§‹åŒ–é”™è¯¯",
    description="ç”¨æˆ·æœåŠ¡åˆå§‹åŒ–å¤±è´¥"
)

# å»ºç«‹å› æœå…³ç³»
navigator.link_problems(from_node_id=cause_id, to_node_id=root_id)

# å¯¼èˆªæ•´ä¸ªé—®é¢˜é“¾
navigator.navigate_problem_chain(root_id)
# â†’ è‡ªåŠ¨è·³è½¬: 50è¡Œ â†’ 100è¡Œ,ä¾æ¬¡å±•ç¤ºé—®é¢˜æ¼”å˜
```

#### å¯¼èˆªå†å²

ç±»ä¼¼æµè§ˆå™¨çš„å‰è¿›/åé€€åŠŸèƒ½:

```python
# è·³è½¬åˆ°å¤šä¸ªä½ç½®
navigator.jump_to_line(100)
navigator.jump_to_line(200)
navigator.jump_to_line(300)

# åé€€
navigator.go_back()  # å›åˆ°200è¡Œ
navigator.go_back()  # å›åˆ°100è¡Œ

# å‰è¿›
navigator.go_forward()  # åˆ°200è¡Œ
```

**UIå¿«æ·é”® (è§„åˆ’ä¸­):**
- `Ctrl+[` : åé€€
- `Ctrl+]` : å‰è¿›
- `Ctrl+G` : è·³è½¬åˆ°æŒ‡å®šè¡Œ

---

### åŠŸèƒ½4: åˆ†æç»“æœç¼“å­˜

**ä¼ ç»Ÿæ–¹å¼é—®é¢˜:**
- ç›¸åŒæ—¥å¿—é‡å¤åˆ†æ,æµªè´¹APIè°ƒç”¨
- ç›¸ä¼¼é—®é¢˜éœ€è¦é‡æ–°é—®AI

**æ™ºèƒ½æ–¹å¼è§£å†³:**

#### ç²¾ç¡®ç¼“å­˜

åŸºäºæŸ¥è¯¢å†…å®¹çš„å“ˆå¸Œå€¼ç¼“å­˜ç»“æœ:

```python
from gui.modules.ai_diagnosis.analysis_cache import AnalysisCache

cache = AnalysisCache(max_size=200)

# ç¬¬ä¸€æ¬¡åˆ†æ
query = "åˆ†æè¿™æ¡å´©æºƒæ—¥å¿—: *** Terminating app..."
result = cache.get(query)

if not result:
    # è°ƒç”¨AI
    result = ai_client.ask(query)
    # ä¿å­˜åˆ°ç¼“å­˜
    cache.put(query, result, problem_type="å´©æºƒ")
else:
    print("âœ“ ç¼“å­˜å‘½ä¸­!")  # ç§’çº§å“åº”
```

#### æ¨¡ç³ŠåŒ¹é…

ç›¸ä¼¼æŸ¥è¯¢ä¹Ÿèƒ½å‘½ä¸­ç¼“å­˜:

```python
# åŸå§‹æŸ¥è¯¢
query1 = "åˆ†æè¿™æ¡å´©æºƒæ—¥å¿—: Exception in thread main"

# ç›¸ä¼¼æŸ¥è¯¢ (è¯åºä¸åŒ,ä½†å†…å®¹ç±»ä¼¼)
query2 = "å´©æºƒæ—¥å¿—åˆ†æ Exception thread main"

# æ¨¡ç³ŠåŒ¹é… (Jaccardç›¸ä¼¼åº¦ > 0.9)
result = cache.get(query2, similarity_threshold=0.9)
# â†’ å‘½ä¸­query1çš„ç¼“å­˜ç»“æœ!
```

#### æŒä¹…åŒ–å­˜å‚¨

ç¼“å­˜è‡ªåŠ¨ä¿å­˜åˆ°æœ¬åœ°æ–‡ä»¶:

```
~/.xinyu_devtools/ai_analysis_cache.json
```

**æ ¼å¼:**
```json
{
  "version": "1.0",
  "saved_at": "2025-10-24T10:30:00",
  "stats": {
    "total_queries": 150,
    "cache_hits": 120,
    "cache_misses": 30,
    "hit_rate": "80%"
  },
  "entries": [
    {
      "query_hash": "a1b2c3d4e5f6g7h8",
      "query_text": "åˆ†æè¿™æ¡å´©æºƒæ—¥å¿—...",
      "ai_response": "è¿™æ˜¯ä¸€ä¸ªç©ºæŒ‡é’ˆå¼‚å¸¸...",
      "problem_type": "å´©æºƒ",
      "hit_count": 5,
      "timestamp": "2025-10-24T09:00:00"
    }
  ]
}
```

#### ç¼“å­˜ç»Ÿè®¡

æŸ¥çœ‹ç¼“å­˜æ•ˆæœ:

```python
stats = cache.get_stats()
print(stats)

# è¾“å‡º:
# {
#   'total_queries': 150,
#   'cache_hits': 120,
#   'cache_misses': 30,
#   'hit_rate': '80.0%',
#   'size': 85,
#   'evictions': 15
# }
```

**æ”¶ç›Šè®¡ç®—:**
- å‡è®¾æ¯æ¬¡AIè°ƒç”¨æˆæœ¬: Â¥0.1
- ç¼“å­˜å‘½ä¸­ç‡: 80%
- æ¯å¤©åˆ†æ100æ¬¡æ—¥å¿—
- **æ¯å¤©èŠ‚çœ**: 100 Ã— 0.8 Ã— Â¥0.1 = **Â¥8**
- **æ¯æœˆèŠ‚çœ**: ~Â¥240

---

## ğŸ“Š æ€§èƒ½å¯¹æ¯”

### åœºæ™¯1: å´©æºƒæ—¥å¿—åˆ†æ

| æŒ‡æ ‡ | ä¼ ç»Ÿæ–¹å¼ | æ™ºèƒ½æ–¹å¼ | æå‡ |
|------|---------|---------|------|
| ä¸Šä¸‹æ–‡æ—¥å¿—æ•°é‡ | 5æ¡ (å‰åå›ºå®š) | 15-20æ¡ (æ™ºèƒ½ç­›é€‰) | **3-4å€** |
| å…³è”æ—¥å¿—å‘ç° | 0æ¡ (ä»…ä¸Šä¸‹æ–‡) | 5-10æ¡ (ç´¢å¼•æœç´¢) | **æ— é™â†’æœ‰** |
| é—®é¢˜å®šä½æ—¶é—´ | ~5åˆ†é’Ÿ (æ‰‹åŠ¨æŸ¥æ‰¾) | ~30ç§’ (ä¸€é”®è·³è½¬) | **10å€** |
| é‡å¤åˆ†æè€—æ—¶ | ~10ç§’ (æ¯æ¬¡è°ƒç”¨AI) | ~0.1ç§’ (ç¼“å­˜) | **100å€** |

### åœºæ™¯2: ç½‘ç»œé—®é¢˜æ’æŸ¥

| æŒ‡æ ‡ | ä¼ ç»Ÿæ–¹å¼ | æ™ºèƒ½æ–¹å¼ | æå‡ |
|------|---------|---------|------|
| å‘ç°è¯·æ±‚-å“åº”å¯¹ | éœ€æ‰‹åŠ¨æœç´¢ | è‡ªåŠ¨å…³è” | **èŠ‚çœ80%æ—¶é—´** |
| è¶…æ—¶åŸå› è¿½æº¯ | éœ€é€è¡Œæ£€æŸ¥ | ç´¢å¼•ç›´è¾¾ | **ç§’çº§å®šä½** |
| é—®é¢˜é“¾è·¯å¯è§†åŒ– | æ—  | è‡ªåŠ¨æ„å»º | **è´¨çš„é£è·ƒ** |

---

## ğŸ› ï¸ é«˜çº§ç”¨æ³•

### è‡ªå®šä¹‰é—®é¢˜ç±»å‹æ£€æµ‹

æ‰©å±•æ£€æµ‹è§„åˆ™:

```python
from gui.modules.ai_diagnosis.smart_context_extractor import SmartContextExtractor, ProblemType

extractor = SmartContextExtractor(all_entries, indexer)

# æ·»åŠ è‡ªå®šä¹‰è§„åˆ™
extractor.problem_patterns[ProblemType.CUSTOM] = [
    r'MyCustomError',
    r'SpecialException',
]

# é…ç½®è‡ªå®šä¹‰ä¸Šä¸‹æ–‡ç­–ç•¥
extractor.context_config[ProblemType.CUSTOM] = {
    'before': 8,
    'after': 4,
    'filter_keywords': ['Custom', 'Special'],
}
```

### æ‰¹é‡åˆ†æ

å¯¹å¤šæ¡æ—¥å¿—æ‰¹é‡åˆ†æ:

```python
from gui.modules.ai_diagnosis.smart_context_extractor import SmartContextExtractor

extractor = SmartContextExtractor(all_entries, indexer)

error_logs = [entry for entry in all_entries if entry.level == 'ERROR']

results = []
for log in error_logs:
    context = extractor.extract_context(log)
    results.append({
        'log': log,
        'problem_type': context['problem_type'],
        'priority': context['priority_score']
    })

# æŒ‰ä¼˜å…ˆçº§æ’åº
results.sort(key=lambda x: x['priority'], reverse=True)

# ä¼˜å…ˆåˆ†æé«˜ä¼˜å…ˆçº§é—®é¢˜
for item in results[:5]:
    print(f"ä¼˜å…ˆçº§: {item['priority']}, ç±»å‹: {item['problem_type']}")
```

### ç¼“å­˜è£…é¥°å™¨

ç®€åŒ–ç¼“å­˜ä½¿ç”¨:

```python
from gui.modules.ai_diagnosis.analysis_cache import cached_analysis

@cached_analysis()
def analyze_crash_log(log_content):
    """åˆ†æå´©æºƒæ—¥å¿— - è‡ªåŠ¨ç¼“å­˜"""
    return ai_client.ask(f"åˆ†æå´©æºƒ: {log_content}")

# ç¬¬ä¸€æ¬¡è°ƒç”¨AI
result1 = analyze_crash_log("Exception: null pointer")

# ç¬¬äºŒæ¬¡ç›´æ¥ä»ç¼“å­˜è¿”å›
result2 = analyze_crash_log("Exception: null pointer")  # âœ“ ç¼“å­˜å‘½ä¸­!
```

---

## ğŸ“ æœ€ä½³å®è·µ

### 1. å……åˆ†åˆ©ç”¨ç´¢å¼•

**å»ºè®®:**
- åŠ è½½å¤§æ—¥å¿—æ–‡ä»¶å,ç­‰å¾…ç´¢å¼•æ„å»ºå®Œæˆ (çŠ¶æ€æ æ˜¾ç¤º "âš¡ç´¢å¼•")
- ç´¢å¼•å°±ç»ªå,AIåˆ†æè´¨é‡æ˜¾è‘—æå‡

**é¿å…:**
- åœ¨ç´¢å¼•æ„å»ºä¸­è¿›è¡ŒAIåˆ†æ (ä¼šé™çº§åˆ°ä¼ ç»Ÿæ–¹å¼)

### 2. åˆç†é…ç½®Tokené™åˆ¶

**å»ºè®®:**
- å´©æºƒåˆ†æ: `max_tokens=10000` (éœ€è¦æ›´å¤šä¸Šä¸‹æ–‡)
- æ™®é€šé”™è¯¯: `max_tokens=5000` (ç²¾ç®€å³å¯)
- æ€§èƒ½é—®é¢˜: `max_tokens=8000` (ä¸­ç­‰)

**ä»£ç :**
```python
context = extractor.extract_context(target_log, max_tokens=10000)
```

### 3. å®šæœŸæ¸…ç†ç¼“å­˜

**å»ºè®®:**
- æ¯å‘¨æ¸…ç†ä¸€æ¬¡è¿‡æœŸç¼“å­˜ (è¶…è¿‡24å°æ—¶)
- ä¿æŒç¼“å­˜å¤§å°åœ¨200æ¡ä»¥å†…

**ä»£ç :**
```python
cache.cleanup_expired(max_age_hours=24)
cache.save_to_file()  # æŒä¹…åŒ–
```

### 4. åˆ©ç”¨å¯¼èˆªå†å²

**å»ºè®®:**
- AIåˆ†æå¤šä¸ªé—®é¢˜å,ä½¿ç”¨å¯¼èˆªå†å²å¿«é€Ÿå›æº¯
- å»ºç«‹é—®é¢˜é“¾è·¯,å½¢æˆå…¨å±€è§†å›¾

---

## ğŸ› æ•…éšœæ’é™¤

### Q1: æ™ºèƒ½åŠŸèƒ½æœªç”Ÿæ•ˆ

**ç—‡çŠ¶:** AIåˆ†æç»“æœä¸ä¼ ç»Ÿæ–¹å¼ä¸€æ ·

**å¯èƒ½åŸå› :**
1. æ™ºèƒ½æ¨¡å—æœªæ­£ç¡®å¯¼å…¥
2. ç´¢å¼•æœªæ„å»ºå®Œæˆ

**è§£å†³:**
```bash
# æ£€æŸ¥æ§åˆ¶å°è¾“å‡º
# åº”è¯¥çœ‹åˆ°:
âœ“ æ—¥å¿—å¯¼èˆªå™¨å·²åˆå§‹åŒ–
âœ“ AIåˆ†æç¼“å­˜å·²åˆå§‹åŒ–
âœ“ æ™ºèƒ½ä¸Šä¸‹æ–‡æå–å®Œæˆ: å´©æºƒ

# å¦‚æœçœ‹åˆ°:
âš ï¸  æ™ºèƒ½AIåŠŸèƒ½æ¨¡å—æœªåŠ è½½
# â†’ æ£€æŸ¥æ¨¡å—å®‰è£…
```

### Q2: ç¼“å­˜æœªå‘½ä¸­

**ç—‡çŠ¶:** ç›¸åŒæŸ¥è¯¢æ¯æ¬¡éƒ½è°ƒç”¨AI

**å¯èƒ½åŸå› :**
1. æŸ¥è¯¢æ–‡æœ¬æ ¼å¼ç•¥æœ‰ä¸åŒ (ç©ºæ ¼ã€æ¢è¡Œ)
2. ç¼“å­˜æ–‡ä»¶æŸå

**è§£å†³:**
```python
# æ‰‹åŠ¨æ£€æŸ¥ç¼“å­˜
cache = get_global_cache()
stats = cache.get_stats()
print(stats)

# å¦‚æœhit_rate = 0%,å°è¯•æ¸…ç©ºé‡å»º
cache.clear()
```

### Q3: è·³è½¬åŠŸèƒ½æ— æ•ˆ

**å¯èƒ½åŸå› :**
- æ—¥å¿—æ˜¾ç¤ºæ§ä»¶æœªæ­£ç¡®ä¼ é€’

**è§£å†³:**
```python
# ç¡®ä¿å¯¼èˆªå™¨åˆå§‹åŒ–æ­£ç¡®
if self.navigator is None:
    navigator = LogNavigator(self.app.log_text, self.app.log_entries)
```

---

## ğŸ“š APIå‚è€ƒ

### SmartContextExtractor

```python
extractor = SmartContextExtractor(all_entries, indexer=None)
context = extractor.extract_context(target_entry, max_tokens=8000)
```

**è¿”å›:**
```python
{
    'problem_type': ProblemType,      # é—®é¢˜ç±»å‹
    'target': LogEntry,               # ç›®æ ‡æ—¥å¿—
    'context_before': [LogEntry],     # å‰ç½®ä¸Šä¸‹æ–‡
    'context_after': [LogEntry],      # åç½®ä¸Šä¸‹æ–‡
    'related_logs': [LogEntry],       # å…³è”æ—¥å¿—
    'summary': str,                   # æ‘˜è¦
    'priority_score': int             # ä¼˜å…ˆçº§ (0-100)
}
```

### LogNavigator

```python
navigator = LogNavigator(log_widget, all_entries)

# è·³è½¬
navigator.jump_to_line(100, reason="AIåˆ†æ")

# æ ‡è®°
navigator.mark_critical_logs([10, 20, 30])

# é—®é¢˜è¿½è¸ª
node_id = navigator.add_problem_node(
    line_number=100,
    problem_type="å´©æºƒ",
    description="ç©ºæŒ‡é’ˆå¼‚å¸¸"
)
```

### AnalysisCache

```python
cache = AnalysisCache(max_size=200)

# æŸ¥è¯¢
result = cache.get(query, similarity_threshold=0.9)

# ä¿å­˜
cache.put(query, response, problem_type="å´©æºƒ")

# ç»Ÿè®¡
stats = cache.get_stats()
```

---

## ğŸ‰ æ€»ç»“

æ–°çš„AIæ™ºèƒ½æ—¥å¿—åˆ†æç³»ç»Ÿé€šè¿‡ä»¥ä¸‹æŠ€æœ¯,å¤§å¹…æå‡é—®é¢˜æ’æŸ¥æ•ˆç‡:

1. **æ™ºèƒ½ä¸Šä¸‹æ–‡æå–** - æ ¹æ®é—®é¢˜ç±»å‹è‡ªåŠ¨è°ƒæ•´,æä¾›3-4å€ä¼˜è´¨ä¸Šä¸‹æ–‡
2. **ç´¢å¼•å…³è”æœç´¢** - å‘ç°éšè—çš„ç›¸å…³æ—¥å¿—,å…¨å±€è§†è§’åˆ†æ
3. **æ—¥å¿—å¯¼èˆª** - ä¸€é”®è·³è½¬,é—®é¢˜é“¾è·¯è¿½è¸ª,èŠ‚çœ50%æ’æŸ¥æ—¶é—´
4. **ç»“æœç¼“å­˜** - ç§’çº§å“åº”,èŠ‚çœ90% APIæˆæœ¬

**å¼€å§‹ä½¿ç”¨:** å³é”®æ—¥å¿— â†’ "ğŸ¤– AIåˆ†ææ­¤æ—¥å¿—" â†’ ä½“éªŒæ™ºèƒ½åˆ†æ!

---

*æ–‡æ¡£ç‰ˆæœ¬: 1.0*
*æœ€åæ›´æ–°: 2025-10-24*
*åé¦ˆé—®é¢˜: [GitHub Issues](https://github.com/your-repo/issues)*
